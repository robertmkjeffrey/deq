|Basic Memory Usage: 8.69MB current, 8.69MB max
====================================================================================================
    - data : ../data/penn/
    - dataset : ptb
    - n_layer : 20
    - d_embed : 400
    - nhid : 1000
    - nout : 400
    - epochs : 500
    - halt_ppl : None
    - time_limit : 16000.0
    - optim : Adam
    - lr : 0.01
    - clip : 0.225
    - batch_size : 32
    - batch_chunk : 1
    - seq_len : 110
    - subseq_len : 55
    - dropout : 0.45
    - dropouti : 0.45
    - wdrop : 0.5
    - emb_dropout : 0.1
    - dropouth : 0.28
    - weight_decay : 1.2e-06
    - wnorm : True
    - seed : 100
    - cuda : True
    - not_tied : False
    - anneal : 10
    - log_interval : 100
    - when : [-1]
    - ksize : 2
    - dilation : 1
    - n_experts : 0
    - multi_gpu : False
    - use_gpus : None
    - f_thres : 45
    - b_thres : 45
    - work_dir : LM-TREdeq-ptb/20d_2kl_unrolled_1_20210512-132859
    - restart : False
    - restart_dir : 
    - debug : False
    - gpu0_bsz : 7
    - pretrain_steps : 2000
    - start_train_steps : 0
    - timing : True
    - eval_mem : False
    - eval : False
    - load : 
    - name : 20d_2kl_unrolled_1
    - tied : True
    - n_token : 10000
    - n_all_param : 24193603
====================================================================================================
#params = 24193603
|Static Memory Usage: 252.25MB current, 269.03MB max
| epoch   1 step      100 |    100 batches | lr 0.01 | ms/batch 558.60 | loss  6.40 | ppl   602.448
| epoch   1 step      200 |    200 batches | lr 0.01 | ms/batch 553.37 | loss  5.79 | ppl   325.762
----------------------------------------------------------------------------------------------------
| Eval   1 at step      265 | time: 151.94s | valid loss  5.37 | valid ppl   215.155
| Total time: 151.73s
----------------------------------------------------------------------------------------------------
| epoch   2 step      300 |     35 batches | lr 0.01 | ms/batch 614.47 | loss  1.96 | ppl     7.120
| epoch   2 step      400 |    135 batches | lr 0.01 | ms/batch 553.35 | loss  5.49 | ppl   242.042
| epoch   2 step      500 |    235 batches | lr 0.01 | ms/batch 553.28 | loss  5.37 | ppl   215.059
----------------------------------------------------------------------------------------------------
| Eval   2 at step      530 | time: 152.76s | valid loss  5.12 | valid ppl   168.173
| Total time: 304.53s
----------------------------------------------------------------------------------------------------
| epoch   3 step      600 |     70 batches | lr 0.01 | ms/batch 616.58 | loss  3.72 | ppl    41.269
| epoch   3 step      700 |    170 batches | lr 0.01 | ms/batch 553.32 | loss  5.26 | ppl   192.507
----------------------------------------------------------------------------------------------------
| Eval   3 at step      795 | time: 153.00s | valid loss  4.96 | valid ppl   142.916
| Total time: 457.49s
----------------------------------------------------------------------------------------------------
| epoch   4 step      800 |      5 batches | lr 0.01 | ms/batch 617.54 | loss  0.27 | ppl     1.309
| epoch   4 step      900 |    105 batches | lr 0.01 | ms/batch 554.49 | loss  5.16 | ppl   174.990
| epoch   4 step     1000 |    205 batches | lr 0.01 | ms/batch 554.73 | loss  5.09 | ppl   161.808
----------------------------------------------------------------------------------------------------
| Eval   4 at step     1060 | time: 153.34s | valid loss  4.87 | valid ppl   130.318
| Total time: 610.78s
----------------------------------------------------------------------------------------------------
| epoch   5 step     1100 |     40 batches | lr 0.01 | ms/batch 617.78 | loss  2.04 | ppl     7.659
| epoch   5 step     1200 |    140 batches | lr 0.01 | ms/batch 554.60 | loss  5.04 | ppl   154.959
| epoch   5 step     1300 |    240 batches | lr 0.01 | ms/batch 554.92 | loss  4.98 | ppl   144.816
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1325 | time: 153.37s | valid loss  4.81 | valid ppl   122.881
| Total time: 764.10s
----------------------------------------------------------------------------------------------------
| epoch   6 step     1400 |     75 batches | lr 0.01 | ms/batch 617.39 | loss  3.74 | ppl    42.276
| epoch   6 step     1500 |    175 batches | lr 0.01 | ms/batch 553.37 | loss  4.96 | ppl   142.641
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1590 | time: 153.00s | valid loss  4.77 | valid ppl   117.769
| Total time: 917.08s
----------------------------------------------------------------------------------------------------
| epoch   7 step     1600 |     10 batches | lr 0.01 | ms/batch 616.97 | loss  0.51 | ppl     1.669
| epoch   7 step     1700 |    110 batches | lr 0.01 | ms/batch 553.37 | loss  4.92 | ppl   137.582
| epoch   7 step     1800 |    210 batches | lr 0.01 | ms/batch 553.28 | loss  4.87 | ppl   130.467
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1855 | time: 152.98s | valid loss  4.73 | valid ppl   113.561
| Total time: 1070.03s
----------------------------------------------------------------------------------------------------
| epoch   8 step     1900 |     45 batches | lr 0.01 | ms/batch 616.79 | loss  2.21 | ppl     9.144
| epoch   8 step     2000 |    145 batches | lr 0.01 | ms/batch 553.38 | loss  4.87 | ppl   130.941
| epoch   8 step     2100 |    245 batches | lr 0.01 | ms/batch 3031.67 | loss  4.81 | ppl   123.226
----------------------------------------------------------------------------------------------------
| Eval   8 at step     2120 | time: 519.60s | valid loss  4.71 | valid ppl   110.823
| Total time: 1589.67s
----------------------------------------------------------------------------------------------------
| epoch   9 step     2200 |     80 batches | lr 0.01 | ms/batch 3780.70 | loss  3.93 | ppl    50.678
| epoch   9 step     2300 |    180 batches | lr 0.01 | ms/batch 3020.12 | loss  4.95 | ppl   140.802
----------------------------------------------------------------------------------------------------
| Eval   9 at step     2385 | time: 875.99s | valid loss  4.79 | valid ppl   120.805
| Total time: 2465.83s
----------------------------------------------------------------------------------------------------
| epoch  10 step     2400 |     15 batches | lr 0.01 | ms/batch 3758.29 | loss  0.75 | ppl     2.118
| epoch  10 step     2500 |    115 batches | lr 0.01 | ms/batch 3019.16 | loss  4.88 | ppl   131.846
| epoch  10 step     2600 |    215 batches | lr 0.01 | ms/batch 3019.43 | loss  4.79 | ppl   120.857
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2650 | time: 874.07s | valid loss  4.70 | valid ppl   110.325
| Total time: 3340.11s
----------------------------------------------------------------------------------------------------
| epoch  11 step     2700 |     50 batches | lr 0.01 | ms/batch 3775.22 | loss  2.43 | ppl    11.304
| epoch  11 step     2800 |    150 batches | lr 0.01 | ms/batch 3019.33 | loss  4.83 | ppl   125.236
| epoch  11 step     2900 |    250 batches | lr 0.01 | ms/batch 3019.53 | loss  4.77 | ppl   117.687
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2915 | time: 875.71s | valid loss  4.68 | valid ppl   107.427
| Total time: 4215.97s
----------------------------------------------------------------------------------------------------
| epoch  12 step     3000 |     85 batches | lr 0.01 | ms/batch 3775.00 | loss  4.08 | ppl    59.087
| epoch  12 step     3100 |    185 batches | lr 0.01 | ms/batch 3020.38 | loss  4.77 | ppl   117.765
----------------------------------------------------------------------------------------------------
| Eval  12 at step     3180 | time: 875.76s | valid loss  4.68 | valid ppl   107.631
| Total time: 5091.89s
----------------------------------------------------------------------------------------------------
| epoch  13 step     3200 |     20 batches | lr 0.01 | ms/batch 3758.85 | loss  0.97 | ppl     2.638
| epoch  13 step     3300 |    120 batches | lr 0.01 | ms/batch 3020.17 | loss  4.79 | ppl   120.770
| epoch  13 step     3400 |    220 batches | lr 0.01 | ms/batch 3022.33 | loss  4.72 | ppl   111.822
----------------------------------------------------------------------------------------------------
| Eval  13 at step     3445 | time: 874.95s | valid loss  4.66 | valid ppl   105.347
| Total time: 5967.06s
----------------------------------------------------------------------------------------------------
| epoch  14 step     3500 |     55 batches | lr 0.01 | ms/batch 3779.14 | loss  2.62 | ppl    13.699
| epoch  14 step     3600 |    155 batches | lr 0.01 | ms/batch 3020.76 | loss  4.76 | ppl   117.128
| epoch  14 step     3700 |    255 batches | lr 0.01 | ms/batch 3020.43 | loss  4.72 | ppl   112.308
----------------------------------------------------------------------------------------------------
| Eval  14 at step     3710 | time: 876.15s | valid loss  4.66 | valid ppl   105.692
| Total time: 6843.36s
----------------------------------------------------------------------------------------------------
| epoch  15 step     3800 |     90 batches | lr 0.01 | ms/batch 3762.68 | loss  4.28 | ppl    72.341
| epoch  15 step     3900 |    190 batches | lr 0.01 | ms/batch 3020.74 | loss  4.69 | ppl   109.251
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3975 | time: 874.47s | valid loss  4.65 | valid ppl   105.072
| Total time: 7718.06s
----------------------------------------------------------------------------------------------------
| epoch  16 step     4000 |     25 batches | lr 0.01 | ms/batch 3774.56 | loss  1.19 | ppl     3.277
| epoch  16 step     4100 |    125 batches | lr 0.01 | ms/batch 3020.63 | loss  4.75 | ppl   115.302
| epoch  16 step     4200 |    225 batches | lr 0.01 | ms/batch 3021.05 | loss  4.67 | ppl   107.090
----------------------------------------------------------------------------------------------------
| Eval  16 at step     4240 | time: 875.93s | valid loss  4.64 | valid ppl   103.125
| Total time: 8594.19s
----------------------------------------------------------------------------------------------------
| epoch  17 step     4300 |     60 batches | lr 0.01 | ms/batch 3774.72 | loss  2.82 | ppl    16.833
| epoch  17 step     4400 |    160 batches | lr 0.01 | ms/batch 3020.66 | loss  4.72 | ppl   112.464
| epoch  17 step     4500 |    260 batches | lr 0.01 | ms/batch 3020.39 | loss  4.68 | ppl   107.473
----------------------------------------------------------------------------------------------------
| Eval  17 at step     4505 | time: 876.17s | valid loss  4.64 | valid ppl   103.285
| Total time: 9470.59s
----------------------------------------------------------------------------------------------------
| epoch  18 step     4600 |     95 batches | lr 0.01 | ms/batch 3763.94 | loss  4.48 | ppl    88.645
| epoch  18 step     4700 |    195 batches | lr 0.01 | ms/batch 3020.65 | loss  4.65 | ppl   104.692
----------------------------------------------------------------------------------------------------
| Eval  18 at step     4770 | time: 874.54s | valid loss  4.63 | valid ppl   102.366
| Total time: 10345.34s
----------------------------------------------------------------------------------------------------
| epoch  19 step     4800 |     30 batches | lr 0.01 | ms/batch 3776.93 | loss  1.42 | ppl     4.122
| epoch  19 step     4900 |    130 batches | lr 0.01 | ms/batch 3033.78 | loss  4.70 | ppl   109.474
| epoch  19 step     5000 |    230 batches | lr 0.01 | ms/batch 3033.93 | loss  4.64 | ppl   104.056
----------------------------------------------------------------------------------------------------
| Eval  19 at step     5035 | time: 879.08s | valid loss  4.62 | valid ppl   101.385
| Total time: 11224.59s
----------------------------------------------------------------------------------------------------
| epoch  20 step     5100 |     65 batches | lr 0.01 | ms/batch 3786.43 | loss  3.05 | ppl    21.066
| epoch  20 step     5200 |    165 batches | lr 0.01 | ms/batch 3033.33 | loss  4.70 | ppl   109.457
| epoch  20 step     5300 |    265 batches | lr 0.01 | ms/batch 2996.19 | loss  4.64 | ppl   103.586
----------------------------------------------------------------------------------------------------
| Eval  20 at step     5300 | time: 878.08s | valid loss  4.61 | valid ppl   100.653
| Total time: 12102.87s
----------------------------------------------------------------------------------------------------
| epoch  21 step     5400 |    100 batches | lr 0.01 | ms/batch 3800.75 | loss  4.69 | ppl   108.918
| epoch  21 step     5500 |    200 batches | lr 0.01 | ms/batch 3020.69 | loss  4.63 | ppl   102.873
----------------------------------------------------------------------------------------------------
| Eval  21 at step     5565 | time: 875.79s | valid loss  4.61 | valid ppl   100.840
| Total time: 12978.88s
----------------------------------------------------------------------------------------------------
| epoch  22 step     5600 |     35 batches | lr 0.01 | ms/batch 3759.53 | loss  1.64 | ppl     5.160
| epoch  22 step     5700 |    135 batches | lr 0.01 | ms/batch 3020.14 | loss  4.68 | ppl   107.378
| epoch  22 step     5800 |    235 batches | lr 0.01 | ms/batch 3020.28 | loss  4.62 | ppl   101.714
----------------------------------------------------------------------------------------------------
| Eval  22 at step     5830 | time: 874.26s | valid loss  4.60 | valid ppl    99.113
| Total time: 13853.37s
----------------------------------------------------------------------------------------------------
| epoch  23 step     5900 |     70 batches | lr 0.01 | ms/batch 3773.96 | loss  3.26 | ppl    26.159
| epoch  23 step     6000 |    170 batches | lr 0.01 | ms/batch 3020.11 | loss  4.67 | ppl   107.194
----------------------------------------------------------------------------------------------------
| Eval  23 at step     6095 | time: 875.83s | valid loss  4.60 | valid ppl    99.167
| Total time: 14729.32s
----------------------------------------------------------------------------------------------------
| epoch  24 step     6100 |      5 batches | lr 0.01 | ms/batch 3760.33 | loss  0.25 | ppl     1.278
| epoch  24 step     6200 |    105 batches | lr 0.01 | ms/batch 3020.17 | loss  4.67 | ppl   106.398
| epoch  24 step     6300 |    205 batches | lr 0.01 | ms/batch 3020.29 | loss  4.61 | ppl   100.715
----------------------------------------------------------------------------------------------------
| Eval  24 at step     6360 | time: 874.32s | valid loss  4.60 | valid ppl    99.336
| Total time: 15603.91s
----------------------------------------------------------------------------------------------------
| epoch  25 step     6400 |     40 batches | lr 0.01 | ms/batch 3759.83 | loss  1.87 | ppl     6.505
| epoch  25 step     6500 |    140 batches | lr 0.01 | ms/batch 3019.94 | loss  4.65 | ppl   104.493
| epoch  25 step     6600 |    240 batches | lr 0.01 | ms/batch 3019.60 | loss  4.61 | ppl   100.634
----------------------------------------------------------------------------------------------------
| Eval  25 at step     6625 | time: 874.21s | valid loss  4.59 | valid ppl    98.772
| Total time: 16478.42s
----------------------------------------------------------------------------------------------------
====================================================================================================
| End of training | test loss  4.55 | test ppl    94.334
| Maximum memory usage: 5568.28MB
====================================================================================================
