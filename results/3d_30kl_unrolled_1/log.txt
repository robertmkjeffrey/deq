|Basic Memory Usage: 8.69MB current, 8.69MB max
====================================================================================================
    - data : ../data/penn/
    - dataset : ptb
    - n_layer : 3
    - d_embed : 400
    - nhid : 1000
    - nout : 400
    - epochs : 500
    - halt_ppl : None
    - time_limit : 16000.0
    - optim : Adam
    - lr : 0.01
    - clip : 0.225
    - batch_size : 32
    - batch_chunk : 1
    - seq_len : 110
    - subseq_len : 55
    - dropout : 0.45
    - dropouti : 0.45
    - wdrop : 0.5
    - emb_dropout : 0.1
    - dropouth : 0.28
    - weight_decay : 1.2e-06
    - wnorm : True
    - seed : 100
    - cuda : True
    - not_tied : False
    - anneal : 10
    - log_interval : 100
    - when : [-1]
    - ksize : 2
    - dilation : 1
    - n_experts : 0
    - multi_gpu : False
    - use_gpus : None
    - f_thres : 45
    - b_thres : 45
    - work_dir : LM-TREdeq-ptb/3d_30kl_unrolled_1_20210512-132648
    - restart : False
    - restart_dir : 
    - debug : False
    - gpu0_bsz : 7
    - pretrain_steps : 30000
    - start_train_steps : 0
    - timing : True
    - eval_mem : False
    - eval : False
    - load : 
    - name : 3d_30kl_unrolled_1
    - tied : True
    - n_token : 10000
    - n_all_param : 24193603
====================================================================================================
#params = 24193603
|Static Memory Usage: 252.25MB current, 269.03MB max
| epoch   1 step      100 |    100 batches | lr 0.01 | ms/batch 97.38 | loss  6.40 | ppl   600.766
| epoch   1 step      200 |    200 batches | lr 0.01 | ms/batch 95.14 | loss  5.75 | ppl   313.871
----------------------------------------------------------------------------------------------------
| Eval   1 at step      265 | time: 26.46s | valid loss  5.35 | valid ppl   211.329
| Total time: 26.47s
----------------------------------------------------------------------------------------------------
| epoch   2 step      300 |     35 batches | lr 0.01 | ms/batch 119.38 | loss  1.96 | ppl     7.086
| epoch   2 step      400 |    135 batches | lr 0.01 | ms/batch 95.17 | loss  5.48 | ppl   238.981
| epoch   2 step      500 |    235 batches | lr 0.01 | ms/batch 95.16 | loss  5.36 | ppl   213.287
----------------------------------------------------------------------------------------------------
| Eval   2 at step      530 | time: 27.64s | valid loss  5.13 | valid ppl   169.431
| Total time: 54.11s
----------------------------------------------------------------------------------------------------
| epoch   3 step      600 |     70 batches | lr 0.01 | ms/batch 121.53 | loss  3.73 | ppl    41.589
| epoch   3 step      700 |    170 batches | lr 0.01 | ms/batch 95.14 | loss  5.28 | ppl   196.800
----------------------------------------------------------------------------------------------------
| Eval   3 at step      795 | time: 27.85s | valid loss  5.02 | valid ppl   151.030
| Total time: 81.91s
----------------------------------------------------------------------------------------------------
| epoch   4 step      800 |      5 batches | lr 0.01 | ms/batch 121.71 | loss  0.27 | ppl     1.311
| epoch   4 step      900 |    105 batches | lr 0.01 | ms/batch 95.12 | loss  5.21 | ppl   182.260
| epoch   4 step     1000 |    205 batches | lr 0.01 | ms/batch 95.13 | loss  5.13 | ppl   168.972
----------------------------------------------------------------------------------------------------
| Eval   4 at step     1060 | time: 27.87s | valid loss  4.95 | valid ppl   141.245
| Total time: 109.71s
----------------------------------------------------------------------------------------------------
| epoch   5 step     1100 |     40 batches | lr 0.01 | ms/batch 121.76 | loss  2.06 | ppl     7.868
| epoch   5 step     1200 |    140 batches | lr 0.01 | ms/batch 95.09 | loss  5.11 | ppl   165.158
| epoch   5 step     1300 |    240 batches | lr 0.01 | ms/batch 95.09 | loss  5.04 | ppl   154.672
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1325 | time: 27.86s | valid loss  4.91 | valid ppl   134.999
| Total time: 137.52s
----------------------------------------------------------------------------------------------------
| epoch   6 step     1400 |     75 batches | lr 0.01 | ms/batch 121.65 | loss  3.81 | ppl    44.963
| epoch   6 step     1500 |    175 batches | lr 0.01 | ms/batch 95.15 | loss  5.04 | ppl   154.894
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1590 | time: 27.86s | valid loss  4.88 | valid ppl   131.300
| Total time: 165.32s
----------------------------------------------------------------------------------------------------
| epoch   7 step     1600 |     10 batches | lr 0.01 | ms/batch 121.53 | loss  0.52 | ppl     1.680
| epoch   7 step     1700 |    110 batches | lr 0.01 | ms/batch 95.14 | loss  5.02 | ppl   151.801
| epoch   7 step     1800 |    210 batches | lr 0.01 | ms/batch 95.09 | loss  4.97 | ppl   143.915
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1855 | time: 27.85s | valid loss  4.86 | valid ppl   129.466
| Total time: 193.11s
----------------------------------------------------------------------------------------------------
| epoch   8 step     1900 |     45 batches | lr 0.01 | ms/batch 121.92 | loss  2.26 | ppl     9.580
| epoch   8 step     2000 |    145 batches | lr 0.01 | ms/batch 95.13 | loss  4.98 | ppl   145.370
| epoch   8 step     2100 |    245 batches | lr 0.01 | ms/batch 95.11 | loss  4.93 | ppl   138.748
----------------------------------------------------------------------------------------------------
| Eval   8 at step     2120 | time: 27.89s | valid loss  4.85 | valid ppl   127.777
| Total time: 220.94s
----------------------------------------------------------------------------------------------------
| epoch   9 step     2200 |     80 batches | lr 0.01 | ms/batch 121.68 | loss  3.97 | ppl    52.940
| epoch   9 step     2300 |    180 batches | lr 0.01 | ms/batch 95.11 | loss  4.93 | ppl   137.952
----------------------------------------------------------------------------------------------------
| Eval   9 at step     2385 | time: 27.87s | valid loss  4.84 | valid ppl   126.718
| Total time: 248.75s
----------------------------------------------------------------------------------------------------
| epoch  10 step     2400 |     15 batches | lr 0.01 | ms/batch 121.60 | loss  0.75 | ppl     2.116
| epoch  10 step     2500 |    115 batches | lr 0.01 | ms/batch 95.16 | loss  4.93 | ppl   139.014
| epoch  10 step     2600 |    215 batches | lr 0.01 | ms/batch 95.11 | loss  4.87 | ppl   130.689
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2650 | time: 27.86s | valid loss  4.83 | valid ppl   125.003
| Total time: 276.55s
----------------------------------------------------------------------------------------------------
| epoch  11 step     2700 |     50 batches | lr 0.01 | ms/batch 121.39 | loss  2.46 | ppl    11.722
| epoch  11 step     2800 |    150 batches | lr 0.01 | ms/batch 95.15 | loss  4.91 | ppl   136.068
| epoch  11 step     2900 |    250 batches | lr 0.01 | ms/batch 95.10 | loss  4.86 | ppl   128.602
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2915 | time: 27.84s | valid loss  4.81 | valid ppl   122.338
| Total time: 304.34s
----------------------------------------------------------------------------------------------------
| epoch  12 step     3000 |     85 batches | lr 0.01 | ms/batch 121.83 | loss  4.16 | ppl    63.772
| epoch  12 step     3100 |    185 batches | lr 0.01 | ms/batch 95.13 | loss  4.87 | ppl   130.126
----------------------------------------------------------------------------------------------------
| Eval  12 at step     3180 | time: 28.05s | valid loss  4.80 | valid ppl   121.236
| Total time: 332.16s
----------------------------------------------------------------------------------------------------
| epoch  13 step     3200 |     20 batches | lr 0.01 | ms/batch 121.71 | loss  0.99 | ppl     2.686
| epoch  13 step     3300 |    120 batches | lr 0.01 | ms/batch 95.14 | loss  4.89 | ppl   132.817
| epoch  13 step     3400 |    220 batches | lr 0.01 | ms/batch 95.09 | loss  4.82 | ppl   123.960
----------------------------------------------------------------------------------------------------
| Eval  13 at step     3445 | time: 27.86s | valid loss  4.79 | valid ppl   120.621
| Total time: 359.97s
----------------------------------------------------------------------------------------------------
| epoch  14 step     3500 |     55 batches | lr 0.01 | ms/batch 121.55 | loss  2.67 | ppl    14.438
| epoch  14 step     3600 |    155 batches | lr 0.01 | ms/batch 95.13 | loss  4.87 | ppl   130.143
| epoch  14 step     3700 |    255 batches | lr 0.01 | ms/batch 95.11 | loss  4.82 | ppl   124.390
----------------------------------------------------------------------------------------------------
| Eval  14 at step     3710 | time: 27.85s | valid loss  4.78 | valid ppl   119.378
| Total time: 387.77s
----------------------------------------------------------------------------------------------------
| epoch  15 step     3800 |     90 batches | lr 0.01 | ms/batch 121.79 | loss  4.37 | ppl    79.312
| epoch  15 step     3900 |    190 batches | lr 0.01 | ms/batch 95.15 | loss  4.81 | ppl   122.990
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3975 | time: 27.87s | valid loss  4.79 | valid ppl   120.136
| Total time: 415.58s
----------------------------------------------------------------------------------------------------
| epoch  16 step     4000 |     25 batches | lr 0.01 | ms/batch 105.31 | loss  1.21 | ppl     3.369
| epoch  16 step     4100 |    125 batches | lr 0.01 | ms/batch 95.14 | loss  4.86 | ppl   129.434
| epoch  16 step     4200 |    225 batches | lr 0.01 | ms/batch 95.06 | loss  4.79 | ppl   120.105
----------------------------------------------------------------------------------------------------
| Eval  16 at step     4240 | time: 26.22s | valid loss  4.78 | valid ppl   119.143
| Total time: 441.81s
----------------------------------------------------------------------------------------------------
| epoch  17 step     4300 |     60 batches | lr 0.01 | ms/batch 121.57 | loss  2.89 | ppl    18.063
| epoch  17 step     4400 |    160 batches | lr 0.01 | ms/batch 95.14 | loss  4.84 | ppl   126.967
| epoch  17 step     4500 |    260 batches | lr 0.01 | ms/batch 95.11 | loss  4.80 | ppl   121.079
----------------------------------------------------------------------------------------------------
| Eval  17 at step     4505 | time: 27.85s | valid loss  4.78 | valid ppl   118.830
| Total time: 469.60s
----------------------------------------------------------------------------------------------------
| epoch  18 step     4600 |     95 batches | lr 0.01 | ms/batch 121.81 | loss  4.59 | ppl    98.962
| epoch  18 step     4700 |    195 batches | lr 0.01 | ms/batch 95.08 | loss  4.77 | ppl   118.321
----------------------------------------------------------------------------------------------------
| Eval  18 at step     4770 | time: 27.87s | valid loss  4.78 | valid ppl   119.289
| Total time: 497.42s
----------------------------------------------------------------------------------------------------
| epoch  19 step     4800 |     30 batches | lr 0.01 | ms/batch 105.32 | loss  1.45 | ppl     4.277
| epoch  19 step     4900 |    130 batches | lr 0.01 | ms/batch 95.17 | loss  4.82 | ppl   123.904
| epoch  19 step     5000 |    230 batches | lr 0.01 | ms/batch 95.14 | loss  4.77 | ppl   118.264
----------------------------------------------------------------------------------------------------
| Eval  19 at step     5035 | time: 26.24s | valid loss  4.77 | valid ppl   117.904
| Total time: 523.66s
----------------------------------------------------------------------------------------------------
| epoch  20 step     5100 |     65 batches | lr 0.01 | ms/batch 121.66 | loss  3.13 | ppl    22.792
| epoch  20 step     5200 |    165 batches | lr 0.01 | ms/batch 95.15 | loss  4.82 | ppl   124.481
| epoch  20 step     5300 |    265 batches | lr 0.01 | ms/batch 94.41 | loss  4.76 | ppl   117.146
----------------------------------------------------------------------------------------------------
| Eval  20 at step     5300 | time: 27.86s | valid loss  4.77 | valid ppl   118.267
| Total time: 551.46s
----------------------------------------------------------------------------------------------------
| epoch  21 step     5400 |    100 batches | lr 0.01 | ms/batch 106.03 | loss  4.81 | ppl   122.822
| epoch  21 step     5500 |    200 batches | lr 0.01 | ms/batch 95.12 | loss  4.77 | ppl   117.750
----------------------------------------------------------------------------------------------------
| Eval  21 at step     5565 | time: 26.24s | valid loss  4.77 | valid ppl   118.389
| Total time: 577.70s
----------------------------------------------------------------------------------------------------
| epoch  22 step     5600 |     35 batches | lr 0.01 | ms/batch 105.43 | loss  1.69 | ppl     5.401
| epoch  22 step     5700 |    135 batches | lr 0.01 | ms/batch 95.18 | loss  4.80 | ppl   122.109
| epoch  22 step     5800 |    235 batches | lr 0.01 | ms/batch 95.17 | loss  4.76 | ppl   116.224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     5830 | time: 26.24s | valid loss  4.78 | valid ppl   118.561
| Total time: 603.94s
----------------------------------------------------------------------------------------------------
| epoch  23 step     5900 |     70 batches | lr 0.01 | ms/batch 105.33 | loss  3.35 | ppl    28.592
| epoch  23 step     6000 |    170 batches | lr 0.01 | ms/batch 95.17 | loss  4.81 | ppl   122.152
----------------------------------------------------------------------------------------------------
| Eval  23 at step     6095 | time: 26.23s | valid loss  4.78 | valid ppl   118.818
| Total time: 630.19s
----------------------------------------------------------------------------------------------------
| epoch  24 step     6100 |      5 batches | lr 0.01 | ms/batch 105.31 | loss  0.25 | ppl     1.285
| epoch  24 step     6200 |    105 batches | lr 0.01 | ms/batch 95.21 | loss  4.80 | ppl   121.131
| epoch  24 step     6300 |    205 batches | lr 0.01 | ms/batch 95.12 | loss  4.75 | ppl   115.786
----------------------------------------------------------------------------------------------------
| Eval  24 at step     6360 | time: 26.23s | valid loss  4.76 | valid ppl   116.637
| Total time: 656.43s
----------------------------------------------------------------------------------------------------
| epoch  25 step     6400 |     40 batches | lr 0.01 | ms/batch 124.10 | loss  1.92 | ppl     6.849
| epoch  25 step     6500 |    140 batches | lr 0.01 | ms/batch 95.14 | loss  4.79 | ppl   119.784
| epoch  25 step     6600 |    240 batches | lr 0.01 | ms/batch 95.14 | loss  4.75 | ppl   115.562
----------------------------------------------------------------------------------------------------
| Eval  25 at step     6625 | time: 28.11s | valid loss  4.76 | valid ppl   116.540
| Total time: 684.48s
----------------------------------------------------------------------------------------------------
| epoch  26 step     6700 |     75 batches | lr 0.01 | ms/batch 121.73 | loss  3.59 | ppl    36.239
| epoch  26 step     6800 |    175 batches | lr 0.01 | ms/batch 95.12 | loss  4.78 | ppl   118.641
----------------------------------------------------------------------------------------------------
| Eval  26 at step     6890 | time: 27.87s | valid loss  4.76 | valid ppl   116.255
| Total time: 712.29s
----------------------------------------------------------------------------------------------------
| epoch  27 step     6900 |     10 batches | lr 0.01 | ms/batch 121.76 | loss  0.49 | ppl     1.632
| epoch  27 step     7000 |    110 batches | lr 0.01 | ms/batch 95.12 | loss  4.78 | ppl   119.058
| epoch  27 step     7100 |    210 batches | lr 0.01 | ms/batch 95.13 | loss  4.74 | ppl   114.332
----------------------------------------------------------------------------------------------------
| Eval  27 at step     7155 | time: 27.87s | valid loss  4.75 | valid ppl   115.967
| Total time: 740.11s
----------------------------------------------------------------------------------------------------
| epoch  28 step     7200 |     45 batches | lr 0.01 | ms/batch 121.70 | loss  2.15 | ppl     8.582
| epoch  28 step     7300 |    145 batches | lr 0.01 | ms/batch 95.16 | loss  4.77 | ppl   117.365
| epoch  28 step     7400 |    245 batches | lr 0.01 | ms/batch 95.12 | loss  4.75 | ppl   115.373
----------------------------------------------------------------------------------------------------
| Eval  28 at step     7420 | time: 27.87s | valid loss  4.76 | valid ppl   116.166
| Total time: 767.92s
----------------------------------------------------------------------------------------------------
| epoch  29 step     7500 |     80 batches | lr 0.01 | ms/batch 105.28 | loss  3.82 | ppl    45.622
| epoch  29 step     7600 |    180 batches | lr 0.01 | ms/batch 95.17 | loss  4.77 | ppl   117.510
----------------------------------------------------------------------------------------------------
| Eval  29 at step     7685 | time: 26.23s | valid loss  4.76 | valid ppl   116.889
| Total time: 794.16s
----------------------------------------------------------------------------------------------------
| epoch  30 step     7700 |     15 batches | lr 0.01 | ms/batch 105.30 | loss  0.72 | ppl     2.064
| epoch  30 step     7800 |    115 batches | lr 0.01 | ms/batch 95.12 | loss  4.77 | ppl   117.469
| epoch  30 step     7900 |    215 batches | lr 0.01 | ms/batch 95.14 | loss  4.73 | ppl   113.027
----------------------------------------------------------------------------------------------------
| Eval  30 at step     7950 | time: 26.23s | valid loss  4.75 | valid ppl   116.147
| Total time: 820.40s
----------------------------------------------------------------------------------------------------
| epoch  31 step     8000 |     50 batches | lr 0.01 | ms/batch 105.31 | loss  2.38 | ppl    10.844
| epoch  31 step     8100 |    150 batches | lr 0.01 | ms/batch 95.16 | loss  4.77 | ppl   117.609
| epoch  31 step     8200 |    250 batches | lr 0.01 | ms/batch 95.13 | loss  4.72 | ppl   112.538
----------------------------------------------------------------------------------------------------
| Eval  31 at step     8215 | time: 26.23s | valid loss  4.76 | valid ppl   116.483
| Total time: 846.64s
----------------------------------------------------------------------------------------------------
| epoch  32 step     8300 |     85 batches | lr 0.01 | ms/batch 105.34 | loss  4.05 | ppl    57.638
| epoch  32 step     8400 |    185 batches | lr 0.01 | ms/batch 95.14 | loss  4.74 | ppl   114.228
----------------------------------------------------------------------------------------------------
| Eval  32 at step     8480 | time: 26.23s | valid loss  4.75 | valid ppl   115.433
| Total time: 872.87s
----------------------------------------------------------------------------------------------------
| epoch  33 step     8500 |     20 batches | lr 0.01 | ms/batch 121.87 | loss  0.96 | ppl     2.607
| epoch  33 step     8600 |    120 batches | lr 0.01 | ms/batch 95.15 | loss  4.78 | ppl   118.607
| epoch  33 step     8700 |    220 batches | lr 0.01 | ms/batch 95.16 | loss  4.70 | ppl   110.080
----------------------------------------------------------------------------------------------------
| Eval  33 at step     8745 | time: 27.89s | valid loss  4.75 | valid ppl   115.678
| Total time: 900.71s
----------------------------------------------------------------------------------------------------
| epoch  34 step     8800 |     55 batches | lr 0.01 | ms/batch 105.31 | loss  2.62 | ppl    13.696
| epoch  34 step     8900 |    155 batches | lr 0.01 | ms/batch 95.16 | loss  4.77 | ppl   118.014
| epoch  34 step     9000 |    255 batches | lr 0.01 | ms/batch 95.16 | loss  4.72 | ppl   112.409
----------------------------------------------------------------------------------------------------
| Eval  34 at step     9010 | time: 26.23s | valid loss  4.76 | valid ppl   116.255
| Total time: 926.94s
----------------------------------------------------------------------------------------------------
| epoch  35 step     9100 |     90 batches | lr 0.01 | ms/batch 105.30 | loss  4.29 | ppl    73.054
| epoch  35 step     9200 |    190 batches | lr 0.01 | ms/batch 95.11 | loss  4.73 | ppl   112.897
----------------------------------------------------------------------------------------------------
| Eval  35 at step     9275 | time: 26.23s | valid loss  4.76 | valid ppl   116.314
| Total time: 953.18s
----------------------------------------------------------------------------------------------------
| epoch  36 step     9300 |     25 batches | lr 0.01 | ms/batch 105.32 | loss  1.19 | ppl     3.292
| epoch  36 step     9400 |    125 batches | lr 0.01 | ms/batch 95.15 | loss  4.76 | ppl   116.489
| epoch  36 step     9500 |    225 batches | lr 0.01 | ms/batch 95.10 | loss  4.69 | ppl   109.364
----------------------------------------------------------------------------------------------------
| Eval  36 at step     9540 | time: 26.22s | valid loss  4.75 | valid ppl   115.251
| Total time: 979.41s
----------------------------------------------------------------------------------------------------
| epoch  37 step     9600 |     60 batches | lr 0.01 | ms/batch 121.66 | loss  2.84 | ppl    17.140
| epoch  37 step     9700 |    160 batches | lr 0.01 | ms/batch 95.12 | loss  4.76 | ppl   117.132
| epoch  37 step     9800 |    260 batches | lr 0.01 | ms/batch 95.12 | loss  4.72 | ppl   112.506
----------------------------------------------------------------------------------------------------
| Eval  37 at step     9805 | time: 27.86s | valid loss  4.75 | valid ppl   115.250
| Total time: 1007.21s
----------------------------------------------------------------------------------------------------
| epoch  38 step     9900 |     95 batches | lr 0.01 | ms/batch 121.52 | loss  4.52 | ppl    91.520
| epoch  38 step    10000 |    195 batches | lr 0.01 | ms/batch 95.13 | loss  4.70 | ppl   110.430
----------------------------------------------------------------------------------------------------
| Eval  38 at step    10070 | time: 27.86s | valid loss  4.74 | valid ppl   114.110
| Total time: 1035.01s
----------------------------------------------------------------------------------------------------
| epoch  39 step    10100 |     30 batches | lr 0.01 | ms/batch 121.66 | loss  1.43 | ppl     4.194
| epoch  39 step    10200 |    130 batches | lr 0.01 | ms/batch 95.12 | loss  4.75 | ppl   116.114
| epoch  39 step    10300 |    230 batches | lr 0.01 | ms/batch 95.14 | loss  4.69 | ppl   108.584
----------------------------------------------------------------------------------------------------
| Eval  39 at step    10335 | time: 27.86s | valid loss  4.74 | valid ppl   114.781
| Total time: 1062.81s
----------------------------------------------------------------------------------------------------
| epoch  40 step    10400 |     65 batches | lr 0.01 | ms/batch 105.29 | loss  3.08 | ppl    21.699
| epoch  40 step    10500 |    165 batches | lr 0.01 | ms/batch 95.14 | loss  4.74 | ppl   114.879
| epoch  40 step    10600 |    265 batches | lr 0.01 | ms/batch 94.35 | loss  4.69 | ppl   108.915
----------------------------------------------------------------------------------------------------
| Eval  40 at step    10600 | time: 26.24s | valid loss  4.74 | valid ppl   114.964
| Total time: 1089.04s
----------------------------------------------------------------------------------------------------
| epoch  41 step    10700 |    100 batches | lr 0.01 | ms/batch 106.01 | loss  4.75 | ppl   115.641
| epoch  41 step    10800 |    200 batches | lr 0.01 | ms/batch 95.16 | loss  4.70 | ppl   109.878
----------------------------------------------------------------------------------------------------
| Eval  41 at step    10865 | time: 26.23s | valid loss  4.74 | valid ppl   114.156
| Total time: 1115.29s
----------------------------------------------------------------------------------------------------
| epoch  42 step    10900 |     35 batches | lr 0.01 | ms/batch 105.37 | loss  1.66 | ppl     5.258
| epoch  42 step    11000 |    135 batches | lr 0.01 | ms/batch 95.13 | loss  4.74 | ppl   114.552
| epoch  42 step    11100 |    235 batches | lr 0.01 | ms/batch 95.17 | loss  4.70 | ppl   110.151
----------------------------------------------------------------------------------------------------
| Eval  42 at step    11130 | time: 26.24s | valid loss  4.73 | valid ppl   113.237
| Total time: 1141.53s
----------------------------------------------------------------------------------------------------
| epoch  43 step    11200 |     70 batches | lr 0.01 | ms/batch 121.57 | loss  3.32 | ppl    27.629
| epoch  43 step    11300 |    170 batches | lr 0.01 | ms/batch 95.15 | loss  4.75 | ppl   115.899
----------------------------------------------------------------------------------------------------
| Eval  43 at step    11395 | time: 27.85s | valid loss  4.73 | valid ppl   112.968
| Total time: 1169.33s
----------------------------------------------------------------------------------------------------
| epoch  44 step    11400 |      5 batches | lr 0.01 | ms/batch 121.68 | loss  0.25 | ppl     1.280
| epoch  44 step    11500 |    105 batches | lr 0.01 | ms/batch 95.16 | loss  4.75 | ppl   115.016
| epoch  44 step    11600 |    205 batches | lr 0.01 | ms/batch 95.12 | loss  4.70 | ppl   109.801
----------------------------------------------------------------------------------------------------
| Eval  44 at step    11660 | time: 27.87s | valid loss  4.74 | valid ppl   114.378
| Total time: 1197.14s
----------------------------------------------------------------------------------------------------
| epoch  45 step    11700 |     40 batches | lr 0.01 | ms/batch 105.30 | loss  1.91 | ppl     6.740
| epoch  45 step    11800 |    140 batches | lr 0.01 | ms/batch 95.13 | loss  4.74 | ppl   114.561
| epoch  45 step    11900 |    240 batches | lr 0.01 | ms/batch 95.16 | loss  4.68 | ppl   107.907
----------------------------------------------------------------------------------------------------
| Eval  45 at step    11925 | time: 26.24s | valid loss  4.74 | valid ppl   114.134
| Total time: 1223.38s
----------------------------------------------------------------------------------------------------
| epoch  46 step    12000 |     75 batches | lr 0.01 | ms/batch 105.31 | loss  3.55 | ppl    34.830
| epoch  46 step    12100 |    175 batches | lr 0.01 | ms/batch 95.13 | loss  4.74 | ppl   114.215
----------------------------------------------------------------------------------------------------
| Eval  46 at step    12190 | time: 26.23s | valid loss  4.73 | valid ppl   112.791
| Total time: 1249.62s
----------------------------------------------------------------------------------------------------
| epoch  47 step    12200 |     10 batches | lr 0.01 | ms/batch 121.58 | loss  0.49 | ppl     1.626
| epoch  47 step    12300 |    110 batches | lr 0.01 | ms/batch 95.13 | loss  4.73 | ppl   112.807
| epoch  47 step    12400 |    210 batches | lr 0.01 | ms/batch 95.15 | loss  4.69 | ppl   109.010
----------------------------------------------------------------------------------------------------
| Eval  47 at step    12455 | time: 27.86s | valid loss  4.73 | valid ppl   112.882
| Total time: 1277.42s
----------------------------------------------------------------------------------------------------
| epoch  48 step    12500 |     45 batches | lr 0.01 | ms/batch 105.35 | loss  2.13 | ppl     8.392
| epoch  48 step    12600 |    145 batches | lr 0.01 | ms/batch 95.17 | loss  4.74 | ppl   114.295
| epoch  48 step    12700 |    245 batches | lr 0.01 | ms/batch 95.15 | loss  4.70 | ppl   109.554
----------------------------------------------------------------------------------------------------
| Eval  48 at step    12720 | time: 26.24s | valid loss  4.72 | valid ppl   112.644
| Total time: 1303.67s
----------------------------------------------------------------------------------------------------
| epoch  49 step    12800 |     80 batches | lr 0.01 | ms/batch 121.77 | loss  3.79 | ppl    44.310
| epoch  49 step    12900 |    180 batches | lr 0.01 | ms/batch 95.18 | loss  4.72 | ppl   111.804
----------------------------------------------------------------------------------------------------
| Eval  49 at step    12985 | time: 27.88s | valid loss  4.72 | valid ppl   112.185
| Total time: 1331.50s
----------------------------------------------------------------------------------------------------
| epoch  50 step    13000 |     15 batches | lr 0.01 | ms/batch 121.96 | loss  0.72 | ppl     2.054
| epoch  50 step    13100 |    115 batches | lr 0.01 | ms/batch 95.16 | loss  4.73 | ppl   113.308
| epoch  50 step    13200 |    215 batches | lr 0.01 | ms/batch 95.20 | loss  4.69 | ppl   109.186
----------------------------------------------------------------------------------------------------
| Eval  50 at step    13250 | time: 27.90s | valid loss  4.72 | valid ppl   112.143
| Total time: 1359.34s
----------------------------------------------------------------------------------------------------
| epoch  51 step    13300 |     50 batches | lr 0.01 | ms/batch 121.63 | loss  2.37 | ppl    10.675
| epoch  51 step    13400 |    150 batches | lr 0.01 | ms/batch 95.17 | loss  4.74 | ppl   114.027
| epoch  51 step    13500 |    250 batches | lr 0.01 | ms/batch 95.19 | loss  4.68 | ppl   108.033
----------------------------------------------------------------------------------------------------
| Eval  51 at step    13515 | time: 27.87s | valid loss  4.73 | valid ppl   113.167
| Total time: 1387.16s
----------------------------------------------------------------------------------------------------
| epoch  52 step    13600 |     85 batches | lr 0.01 | ms/batch 105.29 | loss  4.03 | ppl    56.118
| epoch  52 step    13700 |    185 batches | lr 0.01 | ms/batch 95.16 | loss  4.71 | ppl   110.865
----------------------------------------------------------------------------------------------------
| Eval  52 at step    13780 | time: 26.23s | valid loss  4.73 | valid ppl   113.317
| Total time: 1413.39s
----------------------------------------------------------------------------------------------------
| epoch  53 step    13800 |     20 batches | lr 0.01 | ms/batch 105.32 | loss  0.96 | ppl     2.607
| epoch  53 step    13900 |    120 batches | lr 0.01 | ms/batch 95.17 | loss  4.73 | ppl   113.326
| epoch  53 step    14000 |    220 batches | lr 0.01 | ms/batch 95.18 | loss  4.68 | ppl   107.958
----------------------------------------------------------------------------------------------------
| Eval  53 at step    14045 | time: 26.24s | valid loss  4.73 | valid ppl   113.644
| Total time: 1439.64s
----------------------------------------------------------------------------------------------------
| epoch  54 step    14100 |     55 batches | lr 0.001 | ms/batch 105.31 | loss  2.59 | ppl    13.344
| epoch  54 step    14200 |    155 batches | lr 0.001 | ms/batch 95.15 | loss  4.66 | ppl   105.753
| epoch  54 step    14300 |    255 batches | lr 0.001 | ms/batch 95.15 | loss  4.49 | ppl    89.149
----------------------------------------------------------------------------------------------------
| Eval  54 at step    14310 | time: 26.23s | valid loss  4.71 | valid ppl   110.723
| Total time: 1465.88s
----------------------------------------------------------------------------------------------------
| epoch  55 step    14400 |     90 batches | lr 0.001 | ms/batch 121.90 | loss  4.20 | ppl    66.824
| epoch  55 step    14500 |    190 batches | lr 0.001 | ms/batch 95.15 | loss  4.55 | ppl    94.372
----------------------------------------------------------------------------------------------------
| Eval  55 at step    14575 | time: 27.89s | valid loss  4.69 | valid ppl   109.054
| Total time: 1493.72s
----------------------------------------------------------------------------------------------------
| epoch  56 step    14600 |     25 batches | lr 0.001 | ms/batch 121.82 | loss  1.17 | ppl     3.210
| epoch  56 step    14700 |    125 batches | lr 0.001 | ms/batch 95.15 | loss  4.61 | ppl   100.197
| epoch  56 step    14800 |    225 batches | lr 0.001 | ms/batch 95.18 | loss  4.47 | ppl    87.005
----------------------------------------------------------------------------------------------------
| Eval  56 at step    14840 | time: 27.88s | valid loss  4.69 | valid ppl   108.549
| Total time: 1521.56s
----------------------------------------------------------------------------------------------------
| epoch  57 step    14900 |     60 batches | lr 0.001 | ms/batch 121.98 | loss  2.75 | ppl    15.669
| epoch  57 step    15000 |    160 batches | lr 0.001 | ms/batch 95.19 | loss  4.57 | ppl    96.900
| epoch  57 step    15100 |    260 batches | lr 0.001 | ms/batch 95.15 | loss  4.44 | ppl    85.002
----------------------------------------------------------------------------------------------------
| Eval  57 at step    15105 | time: 27.91s | valid loss  4.68 | valid ppl   107.828
| Total time: 1549.41s
----------------------------------------------------------------------------------------------------
| epoch  58 step    15200 |     95 batches | lr 0.001 | ms/batch 121.85 | loss  4.36 | ppl    78.093
| epoch  58 step    15300 |    195 batches | lr 0.001 | ms/batch 95.18 | loss  4.48 | ppl    87.882
----------------------------------------------------------------------------------------------------
| Eval  58 at step    15370 | time: 27.89s | valid loss  4.68 | valid ppl   107.423
| Total time: 1577.24s
----------------------------------------------------------------------------------------------------
| epoch  59 step    15400 |     30 batches | lr 0.001 | ms/batch 121.50 | loss  1.39 | ppl     3.996
| epoch  59 step    15500 |    130 batches | lr 0.001 | ms/batch 95.16 | loss  4.55 | ppl    94.358
| epoch  59 step    15600 |    230 batches | lr 0.001 | ms/batch 95.18 | loss  4.43 | ppl    84.240
----------------------------------------------------------------------------------------------------
| Eval  59 at step    15635 | time: 27.85s | valid loss  4.67 | valid ppl   107.028
| Total time: 1605.04s
----------------------------------------------------------------------------------------------------
| epoch  60 step    15700 |     65 batches | lr 0.001 | ms/batch 121.84 | loss  2.96 | ppl    19.287
| epoch  60 step    15800 |    165 batches | lr 0.001 | ms/batch 95.14 | loss  4.53 | ppl    92.413
| epoch  60 step    15900 |    265 batches | lr 0.001 | ms/batch 94.45 | loss  4.41 | ppl    82.216
----------------------------------------------------------------------------------------------------
| Eval  60 at step    15900 | time: 27.89s | valid loss  4.67 | valid ppl   106.805
| Total time: 1632.87s
----------------------------------------------------------------------------------------------------
| epoch  61 step    16000 |    100 batches | lr 0.001 | ms/batch 122.52 | loss  4.54 | ppl    93.803
| epoch  61 step    16100 |    200 batches | lr 0.001 | ms/batch 95.14 | loss  4.43 | ppl    84.048
----------------------------------------------------------------------------------------------------
| Eval  61 at step    16165 | time: 27.88s | valid loss  4.67 | valid ppl   106.480
| Total time: 1660.70s
----------------------------------------------------------------------------------------------------
| epoch  62 step    16200 |     35 batches | lr 0.001 | ms/batch 122.10 | loss  1.59 | ppl     4.911
| epoch  62 step    16300 |    135 batches | lr 0.001 | ms/batch 95.14 | loss  4.51 | ppl    90.488
| epoch  62 step    16400 |    235 batches | lr 0.001 | ms/batch 95.20 | loss  4.39 | ppl    80.643
----------------------------------------------------------------------------------------------------
| Eval  62 at step    16430 | time: 27.92s | valid loss  4.67 | valid ppl   106.320
| Total time: 1688.56s
----------------------------------------------------------------------------------------------------
| epoch  63 step    16500 |     70 batches | lr 0.001 | ms/batch 122.13 | loss  3.15 | ppl    23.400
| epoch  63 step    16600 |    170 batches | lr 0.001 | ms/batch 95.20 | loss  4.47 | ppl    87.470
----------------------------------------------------------------------------------------------------
| Eval  63 at step    16695 | time: 27.92s | valid loss  4.66 | valid ppl   106.059
| Total time: 1716.42s
----------------------------------------------------------------------------------------------------
| epoch  64 step    16700 |      5 batches | lr 0.001 | ms/batch 121.76 | loss  0.24 | ppl     1.265
| epoch  64 step    16800 |    105 batches | lr 0.001 | ms/batch 95.21 | loss  4.50 | ppl    89.792
| epoch  64 step    16900 |    205 batches | lr 0.001 | ms/batch 95.18 | loss  4.42 | ppl    82.815
----------------------------------------------------------------------------------------------------
| Eval  64 at step    16960 | time: 27.88s | valid loss  4.66 | valid ppl   106.075
| Total time: 1744.25s
----------------------------------------------------------------------------------------------------
| epoch  65 step    17000 |     40 batches | lr 0.001 | ms/batch 105.34 | loss  1.80 | ppl     6.051
| epoch  65 step    17100 |    140 batches | lr 0.001 | ms/batch 95.18 | loss  4.47 | ppl    87.409
| epoch  65 step    17200 |    240 batches | lr 0.001 | ms/batch 95.16 | loss  4.38 | ppl    79.785
----------------------------------------------------------------------------------------------------
| Eval  65 at step    17225 | time: 26.25s | valid loss  4.67 | valid ppl   106.179
| Total time: 1770.50s
----------------------------------------------------------------------------------------------------
| epoch  66 step    17300 |     75 batches | lr 0.001 | ms/batch 105.42 | loss  3.36 | ppl    28.652
| epoch  66 step    17400 |    175 batches | lr 0.001 | ms/batch 95.15 | loss  4.43 | ppl    84.275
----------------------------------------------------------------------------------------------------
| Eval  66 at step    17490 | time: 26.23s | valid loss  4.66 | valid ppl   106.136
| Total time: 1796.74s
----------------------------------------------------------------------------------------------------
| epoch  67 step    17500 |     10 batches | lr 0.001 | ms/batch 105.32 | loss  0.46 | ppl     1.583
| epoch  67 step    17600 |    110 batches | lr 0.001 | ms/batch 95.16 | loss  4.46 | ppl    86.133
| epoch  67 step    17700 |    210 batches | lr 0.001 | ms/batch 95.17 | loss  4.37 | ppl    79.430
----------------------------------------------------------------------------------------------------
| Eval  67 at step    17755 | time: 26.24s | valid loss  4.66 | valid ppl   106.038
| Total time: 1822.99s
----------------------------------------------------------------------------------------------------
| epoch  68 step    17800 |     45 batches | lr 0.001 | ms/batch 121.83 | loss  2.01 | ppl     7.474
| epoch  68 step    17900 |    145 batches | lr 0.001 | ms/batch 95.14 | loss  4.43 | ppl    83.744
| epoch  68 step    18000 |    245 batches | lr 0.001 | ms/batch 95.18 | loss  4.35 | ppl    77.517
----------------------------------------------------------------------------------------------------
| Eval  68 at step    18020 | time: 27.89s | valid loss  4.66 | valid ppl   105.851
| Total time: 1850.81s
----------------------------------------------------------------------------------------------------
| epoch  69 step    18100 |     80 batches | lr 0.001 | ms/batch 122.21 | loss  3.56 | ppl    35.223
| epoch  69 step    18200 |    180 batches | lr 0.001 | ms/batch 95.17 | loss  4.41 | ppl    82.646
----------------------------------------------------------------------------------------------------
| Eval  69 at step    18285 | time: 27.93s | valid loss  4.66 | valid ppl   105.991
| Total time: 1878.68s
----------------------------------------------------------------------------------------------------
| epoch  70 step    18300 |     15 batches | lr 0.001 | ms/batch 105.38 | loss  0.68 | ppl     1.965
| epoch  70 step    18400 |    115 batches | lr 0.001 | ms/batch 95.19 | loss  4.44 | ppl    84.450
| epoch  70 step    18500 |    215 batches | lr 0.001 | ms/batch 95.20 | loss  4.35 | ppl    77.686
----------------------------------------------------------------------------------------------------
| Eval  70 at step    18550 | time: 26.24s | valid loss  4.66 | valid ppl   105.900
| Total time: 1904.93s
----------------------------------------------------------------------------------------------------
| epoch  71 step    18600 |     50 batches | lr 0.001 | ms/batch 105.31 | loss  2.22 | ppl     9.211
| epoch  71 step    18700 |    150 batches | lr 0.001 | ms/batch 95.15 | loss  4.42 | ppl    82.877
| epoch  71 step    18800 |    250 batches | lr 0.001 | ms/batch 95.17 | loss  4.33 | ppl    75.765
----------------------------------------------------------------------------------------------------
| Eval  71 at step    18815 | time: 26.24s | valid loss  4.66 | valid ppl   105.889
| Total time: 1931.18s
----------------------------------------------------------------------------------------------------
| epoch  72 step    18900 |     85 batches | lr 0.001 | ms/batch 105.35 | loss  3.76 | ppl    42.768
| epoch  72 step    19000 |    185 batches | lr 0.001 | ms/batch 95.18 | loss  4.37 | ppl    79.354
----------------------------------------------------------------------------------------------------
| Eval  72 at step    19080 | time: 26.24s | valid loss  4.67 | valid ppl   106.185
| Total time: 1957.42s
----------------------------------------------------------------------------------------------------
| epoch  73 step    19100 |     20 batches | lr 0.001 | ms/batch 105.35 | loss  0.89 | ppl     2.437
| epoch  73 step    19200 |    120 batches | lr 0.001 | ms/batch 95.17 | loss  4.42 | ppl    83.358
| epoch  73 step    19300 |    220 batches | lr 0.001 | ms/batch 95.16 | loss  4.33 | ppl    75.787
----------------------------------------------------------------------------------------------------
| Eval  73 at step    19345 | time: 26.24s | valid loss  4.67 | valid ppl   106.183
| Total time: 1983.67s
----------------------------------------------------------------------------------------------------
| epoch  74 step    19400 |     55 batches | lr 0.001 | ms/batch 105.37 | loss  2.41 | ppl    11.170
| epoch  74 step    19500 |    155 batches | lr 0.001 | ms/batch 95.22 | loss  4.40 | ppl    81.759
| epoch  74 step    19600 |    255 batches | lr 0.001 | ms/batch 95.16 | loss  4.34 | ppl    76.605
----------------------------------------------------------------------------------------------------
| Eval  74 at step    19610 | time: 26.24s | valid loss  4.66 | valid ppl   106.160
| Total time: 2009.93s
----------------------------------------------------------------------------------------------------
| epoch  75 step    19700 |     90 batches | lr 0.0001 | ms/batch 105.34 | loss  3.98 | ppl    53.543
| epoch  75 step    19800 |    190 batches | lr 0.0001 | ms/batch 95.15 | loss  4.34 | ppl    76.971
----------------------------------------------------------------------------------------------------
| Eval  75 at step    19875 | time: 26.23s | valid loss  4.67 | valid ppl   106.353
| Total time: 2036.17s
----------------------------------------------------------------------------------------------------
| epoch  76 step    19900 |     25 batches | lr 1e-05 | ms/batch 105.33 | loss  1.10 | ppl     3.013
| epoch  76 step    20000 |    125 batches | lr 1e-05 | ms/batch 95.21 | loss  4.40 | ppl    81.801
| epoch  76 step    20100 |    225 batches | lr 1e-05 | ms/batch 95.18 | loss  4.30 | ppl    73.648
----------------------------------------------------------------------------------------------------
| Eval  76 at step    20140 | time: 26.24s | valid loss  4.67 | valid ppl   106.271
| Total time: 2062.42s
----------------------------------------------------------------------------------------------------
| epoch  77 step    20200 |     60 batches | lr 1e-05 | ms/batch 105.38 | loss  2.63 | ppl    13.938
| epoch  77 step    20300 |    160 batches | lr 1e-05 | ms/batch 95.16 | loss  4.38 | ppl    80.026
| epoch  77 step    20400 |    260 batches | lr 1e-05 | ms/batch 95.16 | loss  4.31 | ppl    74.307
----------------------------------------------------------------------------------------------------
| Eval  77 at step    20405 | time: 26.24s | valid loss  4.67 | valid ppl   106.225
| Total time: 2088.67s
----------------------------------------------------------------------------------------------------
| epoch  78 step    20500 |     95 batches | lr 1e-05 | ms/batch 105.39 | loss  4.19 | ppl    66.084
| epoch  78 step    20600 |    195 batches | lr 1e-05 | ms/batch 95.16 | loss  4.34 | ppl    76.782
----------------------------------------------------------------------------------------------------
| Eval  78 at step    20670 | time: 26.24s | valid loss  4.67 | valid ppl   106.176
| Total time: 2114.92s
----------------------------------------------------------------------------------------------------
| epoch  79 step    20700 |     30 batches | lr 1e-05 | ms/batch 105.36 | loss  1.33 | ppl     3.762
| epoch  79 step    20800 |    130 batches | lr 1e-05 | ms/batch 95.14 | loss  4.41 | ppl    82.599
| epoch  79 step    20900 |    230 batches | lr 1e-05 | ms/batch 95.12 | loss  4.30 | ppl    73.925
----------------------------------------------------------------------------------------------------
| Eval  79 at step    20935 | time: 26.23s | valid loss  4.66 | valid ppl   106.143
| Total time: 2141.16s
----------------------------------------------------------------------------------------------------
| epoch  80 step    21000 |     65 batches | lr 1e-05 | ms/batch 105.32 | loss  2.86 | ppl    17.448
| epoch  80 step    21100 |    165 batches | lr 1e-05 | ms/batch 95.16 | loss  4.39 | ppl    80.288
| epoch  80 step    21200 |    265 batches | lr 1e-05 | ms/batch 94.40 | loss  4.28 | ppl    72.129
----------------------------------------------------------------------------------------------------
| Eval  80 at step    21200 | time: 26.23s | valid loss  4.66 | valid ppl   106.109
| Total time: 2167.40s
----------------------------------------------------------------------------------------------------
| epoch  81 step    21300 |    100 batches | lr 1e-05 | ms/batch 106.03 | loss  4.41 | ppl    82.454
| epoch  81 step    21400 |    200 batches | lr 1e-05 | ms/batch 95.16 | loss  4.33 | ppl    76.046
----------------------------------------------------------------------------------------------------
| Eval  81 at step    21465 | time: 26.23s | valid loss  4.66 | valid ppl   106.078
| Total time: 2193.64s
----------------------------------------------------------------------------------------------------
| epoch  82 step    21500 |     35 batches | lr 1e-05 | ms/batch 105.33 | loss  1.55 | ppl     4.723
| epoch  82 step    21600 |    135 batches | lr 1e-05 | ms/batch 95.16 | loss  4.40 | ppl    81.297
| epoch  82 step    21700 |    235 batches | lr 1e-05 | ms/batch 95.16 | loss  4.30 | ppl    73.390
----------------------------------------------------------------------------------------------------
| Eval  82 at step    21730 | time: 26.24s | valid loss  4.66 | valid ppl   106.058
| Total time: 2219.89s
----------------------------------------------------------------------------------------------------
| epoch  83 step    21800 |     70 batches | lr 1e-05 | ms/batch 105.34 | loss  3.08 | ppl    21.746
| epoch  83 step    21900 |    170 batches | lr 1e-05 | ms/batch 95.17 | loss  4.38 | ppl    79.690
----------------------------------------------------------------------------------------------------
| Eval  83 at step    21995 | time: 26.23s | valid loss  4.66 | valid ppl   106.030
| Total time: 2246.13s
----------------------------------------------------------------------------------------------------
| epoch  84 step    22000 |      5 batches | lr 1e-05 | ms/batch 105.31 | loss  0.23 | ppl     1.260
| epoch  84 step    22100 |    105 batches | lr 1e-05 | ms/batch 95.13 | loss  4.40 | ppl    81.683
| epoch  84 step    22200 |    205 batches | lr 1e-05 | ms/batch 95.15 | loss  4.32 | ppl    75.035
----------------------------------------------------------------------------------------------------
| Eval  84 at step    22260 | time: 26.24s | valid loss  4.66 | valid ppl   106.005
| Total time: 2272.37s
----------------------------------------------------------------------------------------------------
| epoch  85 step    22300 |     40 batches | lr 1e-05 | ms/batch 105.37 | loss  1.78 | ppl     5.936
| epoch  85 step    22400 |    140 batches | lr 1e-05 | ms/batch 95.16 | loss  4.38 | ppl    79.853
| epoch  85 step    22500 |    240 batches | lr 1e-05 | ms/batch 95.13 | loss  4.29 | ppl    73.226
----------------------------------------------------------------------------------------------------
| Eval  85 at step    22525 | time: 26.23s | valid loss  4.66 | valid ppl   105.987
| Total time: 2298.61s
----------------------------------------------------------------------------------------------------
| epoch  86 step    22600 |     75 batches | lr 1e-05 | ms/batch 105.32 | loss  3.31 | ppl    27.261
| epoch  86 step    22700 |    175 batches | lr 1e-05 | ms/batch 95.13 | loss  4.37 | ppl    78.678
----------------------------------------------------------------------------------------------------
| Eval  86 at step    22790 | time: 26.22s | valid loss  4.66 | valid ppl   105.975
| Total time: 2324.84s
----------------------------------------------------------------------------------------------------
| epoch  87 step    22800 |     10 batches | lr 1e-05 | ms/batch 105.26 | loss  0.45 | ppl     1.575
| epoch  87 step    22900 |    110 batches | lr 1e-05 | ms/batch 95.17 | loss  4.40 | ppl    81.660
| epoch  87 step    23000 |    210 batches | lr 1e-05 | ms/batch 95.13 | loss  4.32 | ppl    75.361
----------------------------------------------------------------------------------------------------
| Eval  87 at step    23055 | time: 26.23s | valid loss  4.66 | valid ppl   105.963
| Total time: 2351.09s
----------------------------------------------------------------------------------------------------
| epoch  88 step    23100 |     45 batches | lr 1e-05 | ms/batch 105.34 | loss  1.99 | ppl     7.319
| epoch  88 step    23200 |    145 batches | lr 1e-05 | ms/batch 95.15 | loss  4.39 | ppl    80.756
| epoch  88 step    23300 |    245 batches | lr 1e-05 | ms/batch 95.18 | loss  4.30 | ppl    73.856
----------------------------------------------------------------------------------------------------
| Eval  88 at step    23320 | time: 26.24s | valid loss  4.66 | valid ppl   105.952
| Total time: 2377.33s
----------------------------------------------------------------------------------------------------
| epoch  89 step    23400 |     80 batches | lr 1e-05 | ms/batch 105.29 | loss  3.53 | ppl    33.979
| epoch  89 step    23500 |    180 batches | lr 1e-05 | ms/batch 95.14 | loss  4.36 | ppl    78.373
----------------------------------------------------------------------------------------------------
| Eval  89 at step    23585 | time: 26.23s | valid loss  4.66 | valid ppl   105.949
| Total time: 2403.56s
----------------------------------------------------------------------------------------------------
| epoch  90 step    23600 |     15 batches | lr 1e-05 | ms/batch 105.30 | loss  0.67 | ppl     1.955
| epoch  90 step    23700 |    115 batches | lr 1e-05 | ms/batch 95.13 | loss  4.40 | ppl    81.344
| epoch  90 step    23800 |    215 batches | lr 1e-05 | ms/batch 95.14 | loss  4.30 | ppl    73.875
----------------------------------------------------------------------------------------------------
| Eval  90 at step    23850 | time: 26.23s | valid loss  4.66 | valid ppl   105.940
| Total time: 2429.80s
----------------------------------------------------------------------------------------------------
| epoch  91 step    23900 |     50 batches | lr 1e-05 | ms/batch 105.32 | loss  2.20 | ppl     9.063
| epoch  91 step    24000 |    150 batches | lr 1e-05 | ms/batch 95.23 | loss  4.39 | ppl    80.430
| epoch  91 step    24100 |    250 batches | lr 1e-05 | ms/batch 95.15 | loss  4.30 | ppl    73.625
----------------------------------------------------------------------------------------------------
| Eval  91 at step    24115 | time: 26.24s | valid loss  4.66 | valid ppl   105.945
| Total time: 2456.05s
----------------------------------------------------------------------------------------------------
| epoch  92 step    24200 |     85 batches | lr 1e-05 | ms/batch 105.27 | loss  3.74 | ppl    42.140
| epoch  92 step    24300 |    185 batches | lr 1e-05 | ms/batch 95.15 | loss  4.34 | ppl    76.968
----------------------------------------------------------------------------------------------------
| Eval  92 at step    24380 | time: 26.23s | valid loss  4.66 | valid ppl   105.938
| Total time: 2482.29s
----------------------------------------------------------------------------------------------------
| epoch  93 step    24400 |     20 batches | lr 1e-05 | ms/batch 105.36 | loss  0.89 | ppl     2.443
| epoch  93 step    24500 |    120 batches | lr 1e-05 | ms/batch 95.15 | loss  4.40 | ppl    81.808
| epoch  93 step    24600 |    220 batches | lr 1e-05 | ms/batch 95.13 | loss  4.29 | ppl    73.063
----------------------------------------------------------------------------------------------------
| Eval  93 at step    24645 | time: 26.24s | valid loss  4.66 | valid ppl   105.916
| Total time: 2508.53s
----------------------------------------------------------------------------------------------------
| epoch  94 step    24700 |     55 batches | lr 1e-05 | ms/batch 105.34 | loss  2.42 | ppl    11.265
| epoch  94 step    24800 |    155 batches | lr 1e-05 | ms/batch 95.15 | loss  4.38 | ppl    80.222
| epoch  94 step    24900 |    255 batches | lr 1e-05 | ms/batch 95.13 | loss  4.31 | ppl    74.464
----------------------------------------------------------------------------------------------------
| Eval  94 at step    24910 | time: 26.23s | valid loss  4.66 | valid ppl   105.918
| Total time: 2534.77s
----------------------------------------------------------------------------------------------------
| epoch  95 step    25000 |     90 batches | lr 1e-05 | ms/batch 105.33 | loss  3.97 | ppl    52.770
| epoch  95 step    25100 |    190 batches | lr 1e-05 | ms/batch 95.16 | loss  4.33 | ppl    75.825
----------------------------------------------------------------------------------------------------
| Eval  95 at step    25175 | time: 26.23s | valid loss  4.66 | valid ppl   105.903
| Total time: 2561.01s
----------------------------------------------------------------------------------------------------
| epoch  96 step    25200 |     25 batches | lr 1e-05 | ms/batch 105.29 | loss  1.11 | ppl     3.022
| epoch  96 step    25300 |    125 batches | lr 1e-05 | ms/batch 95.16 | loss  4.40 | ppl    81.212
| epoch  96 step    25400 |    225 batches | lr 1e-05 | ms/batch 95.17 | loss  4.29 | ppl    73.148
----------------------------------------------------------------------------------------------------
| Eval  96 at step    25440 | time: 26.24s | valid loss  4.66 | valid ppl   105.916
| Total time: 2587.26s
----------------------------------------------------------------------------------------------------
| epoch  97 step    25500 |     60 batches | lr 1e-05 | ms/batch 105.32 | loss  2.63 | ppl    13.930
| epoch  97 step    25600 |    160 batches | lr 1e-05 | ms/batch 95.17 | loss  4.39 | ppl    80.577
| epoch  97 step    25700 |    260 batches | lr 1e-05 | ms/batch 95.15 | loss  4.32 | ppl    75.219
----------------------------------------------------------------------------------------------------
| Eval  97 at step    25705 | time: 26.23s | valid loss  4.66 | valid ppl   105.913
| Total time: 2613.50s
----------------------------------------------------------------------------------------------------
| epoch  98 step    25800 |     95 batches | lr 1e-05 | ms/batch 105.34 | loss  4.19 | ppl    65.768
| epoch  98 step    25900 |    195 batches | lr 1e-05 | ms/batch 95.19 | loss  4.32 | ppl    75.285
----------------------------------------------------------------------------------------------------
| Eval  98 at step    25970 | time: 26.24s | valid loss  4.66 | valid ppl   105.905
| Total time: 2639.75s
----------------------------------------------------------------------------------------------------
| epoch  99 step    26000 |     30 batches | lr 1e-05 | ms/batch 105.32 | loss  1.33 | ppl     3.766
| epoch  99 step    26100 |    130 batches | lr 1e-05 | ms/batch 95.14 | loss  4.38 | ppl    80.120
| epoch  99 step    26200 |    230 batches | lr 1e-05 | ms/batch 95.14 | loss  4.28 | ppl    72.096
----------------------------------------------------------------------------------------------------
| Eval  99 at step    26235 | time: 26.23s | valid loss  4.66 | valid ppl   105.903
| Total time: 2665.99s
----------------------------------------------------------------------------------------------------
| epoch 100 step    26300 |     65 batches | lr 1e-05 | ms/batch 105.33 | loss  2.86 | ppl    17.413
| epoch 100 step    26400 |    165 batches | lr 1e-05 | ms/batch 95.18 | loss  4.38 | ppl    80.015
| epoch 100 step    26500 |    265 batches | lr 1e-05 | ms/batch 94.45 | loss  4.28 | ppl    72.144
----------------------------------------------------------------------------------------------------
| Eval 100 at step    26500 | time: 26.24s | valid loss  4.66 | valid ppl   105.897
| Total time: 2692.23s
----------------------------------------------------------------------------------------------------
| epoch 101 step    26600 |    100 batches | lr 1e-05 | ms/batch 106.05 | loss  4.41 | ppl    82.500
| epoch 101 step    26700 |    200 batches | lr 1e-05 | ms/batch 95.18 | loss  4.32 | ppl    75.558
----------------------------------------------------------------------------------------------------
| Eval 101 at step    26765 | time: 26.24s | valid loss  4.66 | valid ppl   105.901
| Total time: 2718.48s
----------------------------------------------------------------------------------------------------
| epoch 102 step    26800 |     35 batches | lr 1e-05 | ms/batch 105.37 | loss  1.54 | ppl     4.681
| epoch 102 step    26900 |    135 batches | lr 1e-05 | ms/batch 95.15 | loss  4.39 | ppl    80.288
| epoch 102 step    27000 |    235 batches | lr 1e-05 | ms/batch 95.16 | loss  4.29 | ppl    72.947
----------------------------------------------------------------------------------------------------
| Eval 102 at step    27030 | time: 26.24s | valid loss  4.66 | valid ppl   105.889
| Total time: 2744.73s
----------------------------------------------------------------------------------------------------
| epoch 103 step    27100 |     70 batches | lr 1e-05 | ms/batch 105.32 | loss  3.09 | ppl    21.885
| epoch 103 step    27200 |    170 batches | lr 1e-05 | ms/batch 95.13 | loss  4.37 | ppl    79.324
----------------------------------------------------------------------------------------------------
| Eval 103 at step    27295 | time: 26.23s | valid loss  4.66 | valid ppl   105.876
| Total time: 2770.97s
----------------------------------------------------------------------------------------------------
| epoch 104 step    27300 |      5 batches | lr 1e-05 | ms/batch 105.34 | loss  0.23 | ppl     1.257
| epoch 104 step    27400 |    105 batches | lr 1e-05 | ms/batch 95.15 | loss  4.39 | ppl    80.777
| epoch 104 step    27500 |    205 batches | lr 1e-05 | ms/batch 95.13 | loss  4.32 | ppl    75.026
----------------------------------------------------------------------------------------------------
| Eval 104 at step    27560 | time: 26.23s | valid loss  4.66 | valid ppl   105.884
| Total time: 2797.21s
----------------------------------------------------------------------------------------------------
| epoch 105 step    27600 |     40 batches | lr 1e-05 | ms/batch 105.33 | loss  1.77 | ppl     5.866
| epoch 105 step    27700 |    140 batches | lr 1e-05 | ms/batch 95.16 | loss  4.38 | ppl    79.865
| epoch 105 step    27800 |    240 batches | lr 1e-05 | ms/batch 95.17 | loss  4.29 | ppl    73.229
----------------------------------------------------------------------------------------------------
| Eval 105 at step    27825 | time: 26.24s | valid loss  4.66 | valid ppl   105.880
| Total time: 2823.45s
----------------------------------------------------------------------------------------------------
| epoch 106 step    27900 |     75 batches | lr 1e-05 | ms/batch 105.30 | loss  3.30 | ppl    27.071
| epoch 106 step    28000 |    175 batches | lr 1e-05 | ms/batch 95.17 | loss  4.36 | ppl    77.934
----------------------------------------------------------------------------------------------------
| Eval 106 at step    28090 | time: 26.23s | valid loss  4.66 | valid ppl   105.870
| Total time: 2849.69s
----------------------------------------------------------------------------------------------------
| epoch 107 step    28100 |     10 batches | lr 1e-05 | ms/batch 105.30 | loss  0.45 | ppl     1.574
| epoch 107 step    28200 |    110 batches | lr 1e-05 | ms/batch 95.15 | loss  4.39 | ppl    80.715
| epoch 107 step    28300 |    210 batches | lr 1e-05 | ms/batch 95.15 | loss  4.32 | ppl    75.524
----------------------------------------------------------------------------------------------------
| Eval 107 at step    28355 | time: 26.23s | valid loss  4.66 | valid ppl   105.863
| Total time: 2875.93s
----------------------------------------------------------------------------------------------------
| epoch 108 step    28400 |     45 batches | lr 1e-05 | ms/batch 105.32 | loss  1.99 | ppl     7.287
| epoch 108 step    28500 |    145 batches | lr 1e-05 | ms/batch 95.14 | loss  4.37 | ppl    79.179
| epoch 108 step    28600 |    245 batches | lr 1e-05 | ms/batch 95.11 | loss  4.30 | ppl    74.007
----------------------------------------------------------------------------------------------------
| Eval 108 at step    28620 | time: 26.23s | valid loss  4.66 | valid ppl   105.868
| Total time: 2902.17s
----------------------------------------------------------------------------------------------------
| epoch 109 step    28700 |     80 batches | lr 1e-05 | ms/batch 105.37 | loss  3.53 | ppl    34.041
| epoch 109 step    28800 |    180 batches | lr 1e-05 | ms/batch 95.15 | loss  4.37 | ppl    79.133
----------------------------------------------------------------------------------------------------
| Eval 109 at step    28885 | time: 26.24s | valid loss  4.66 | valid ppl   105.864
| Total time: 2928.42s
----------------------------------------------------------------------------------------------------
| epoch 110 step    28900 |     15 batches | lr 1e-05 | ms/batch 105.34 | loss  0.67 | ppl     1.957
| epoch 110 step    29000 |    115 batches | lr 1e-05 | ms/batch 95.18 | loss  4.38 | ppl    79.913
| epoch 110 step    29100 |    215 batches | lr 1e-05 | ms/batch 95.13 | loss  4.30 | ppl    73.775
----------------------------------------------------------------------------------------------------
| Eval 110 at step    29150 | time: 26.24s | valid loss  4.66 | valid ppl   105.855
| Total time: 2954.66s
----------------------------------------------------------------------------------------------------
| epoch 111 step    29200 |     50 batches | lr 1e-05 | ms/batch 105.33 | loss  2.20 | ppl     8.992
| epoch 111 step    29300 |    150 batches | lr 1e-05 | ms/batch 95.15 | loss  4.38 | ppl    80.205
| epoch 111 step    29400 |    250 batches | lr 1e-05 | ms/batch 95.16 | loss  4.30 | ppl    73.453
----------------------------------------------------------------------------------------------------
| Eval 111 at step    29415 | time: 26.23s | valid loss  4.66 | valid ppl   105.856
| Total time: 2980.90s
----------------------------------------------------------------------------------------------------
| epoch 112 step    29500 |     85 batches | lr 1e-05 | ms/batch 105.34 | loss  3.74 | ppl    41.989
| epoch 112 step    29600 |    185 batches | lr 1e-05 | ms/batch 95.19 | loss  4.35 | ppl    77.325
----------------------------------------------------------------------------------------------------
| Eval 112 at step    29680 | time: 26.24s | valid loss  4.66 | valid ppl   105.872
| Total time: 3007.15s
----------------------------------------------------------------------------------------------------
| epoch 113 step    29700 |     20 batches | lr 1e-05 | ms/batch 105.34 | loss  0.89 | ppl     2.428
| epoch 113 step    29800 |    120 batches | lr 1e-05 | ms/batch 95.13 | loss  4.40 | ppl    81.136
| epoch 113 step    29900 |    220 batches | lr 1e-05 | ms/batch 95.10 | loss  4.30 | ppl    73.691
----------------------------------------------------------------------------------------------------
| Eval 113 at step    29945 | time: 26.23s | valid loss  4.66 | valid ppl   105.871
| Total time: 3033.39s
----------------------------------------------------------------------------------------------------
| epoch 114 step    30000 |     55 batches | lr 1e-05 | ms/batch 105.34 | loss  2.42 | ppl    11.200
| epoch 114 step    30100 |    155 batches | lr 1e-05 | ms/batch 3029.85 | loss  4.51 | ppl    90.901
| epoch 114 step    30200 |    255 batches | lr 1e-05 | ms/batch 3029.30 | loss  4.41 | ppl    82.357
----------------------------------------------------------------------------------------------------
| Eval 114 at step    30210 | time: 715.46s | valid loss  4.58 | valid ppl    97.885
| Total time: 3749.12s
----------------------------------------------------------------------------------------------------
| epoch 115 step    30300 |     90 batches | lr 1e-05 | ms/batch 3784.03 | loss  4.00 | ppl    54.645
| epoch 115 step    30400 |    190 batches | lr 1e-05 | ms/batch 3029.05 | loss  4.34 | ppl    76.593
----------------------------------------------------------------------------------------------------
| Eval 115 at step    30475 | time: 878.42s | valid loss  4.62 | valid ppl   101.590
| Total time: 4627.80s
----------------------------------------------------------------------------------------------------
| epoch 116 step    30500 |     25 batches | lr 1e-05 | ms/batch 3771.77 | loss  1.11 | ppl     3.035
| epoch 116 step    30600 |    125 batches | lr 1e-05 | ms/batch 3029.32 | loss  4.38 | ppl    80.060
| epoch 116 step    30700 |    225 batches | lr 1e-05 | ms/batch 3029.51 | loss  4.30 | ppl    73.509
----------------------------------------------------------------------------------------------------
| Eval 116 at step    30740 | time: 876.87s | valid loss  4.59 | valid ppl    98.605
| Total time: 5505.01s
----------------------------------------------------------------------------------------------------
| epoch 117 step    30800 |     60 batches | lr 1e-05 | ms/batch 3769.09 | loss  2.63 | ppl    13.875
| epoch 117 step    30900 |    160 batches | lr 1e-05 | ms/batch 3028.77 | loss  4.37 | ppl    79.018
| epoch 117 step    31000 |    260 batches | lr 1e-05 | ms/batch 3028.55 | loss  4.29 | ppl    73.162
----------------------------------------------------------------------------------------------------
| Eval 117 at step    31005 | time: 876.53s | valid loss  4.59 | valid ppl    98.700
| Total time: 6381.87s
----------------------------------------------------------------------------------------------------
| epoch 118 step    31100 |     95 batches | lr 1e-05 | ms/batch 3768.62 | loss  4.17 | ppl    64.625
| epoch 118 step    31200 |    195 batches | lr 1e-05 | ms/batch 3029.00 | loss  4.30 | ppl    73.667
----------------------------------------------------------------------------------------------------
| Eval 118 at step    31270 | time: 876.88s | valid loss  4.59 | valid ppl    98.212
| Total time: 7259.10s
----------------------------------------------------------------------------------------------------
| epoch 119 step    31300 |     30 batches | lr 1e-05 | ms/batch 3770.79 | loss  1.32 | ppl     3.744
| epoch 119 step    31400 |    130 batches | lr 1e-05 | ms/batch 3028.09 | loss  4.38 | ppl    79.559
| epoch 119 step    31500 |    230 batches | lr 1e-05 | ms/batch 3028.25 | loss  4.29 | ppl    72.735
----------------------------------------------------------------------------------------------------
| Eval 119 at step    31535 | time: 876.47s | valid loss  4.58 | valid ppl    97.980
| Total time: 8135.88s
----------------------------------------------------------------------------------------------------
| epoch 120 step    31600 |     65 batches | lr 1e-05 | ms/batch 3767.64 | loss  2.84 | ppl    17.111
| epoch 120 step    31700 |    165 batches | lr 1e-05 | ms/batch 3028.18 | loss  4.36 | ppl    77.906
| epoch 120 step    31800 |    265 batches | lr 1e-05 | ms/batch 2999.81 | loss  4.26 | ppl    71.086
----------------------------------------------------------------------------------------------------
| Eval 120 at step    31800 | time: 876.44s | valid loss  4.58 | valid ppl    97.927
| Total time: 9012.65s
----------------------------------------------------------------------------------------------------
| epoch 121 step    31900 |    100 batches | lr 1e-05 | ms/batch 3796.44 | loss  4.38 | ppl    79.934
| epoch 121 step    32000 |    200 batches | lr 1e-05 | ms/batch 3027.96 | loss  4.28 | ppl    72.462
----------------------------------------------------------------------------------------------------
| Eval 121 at step    32065 | time: 876.50s | valid loss  4.58 | valid ppl    97.835
| Total time: 9889.48s
----------------------------------------------------------------------------------------------------
| epoch 122 step    32100 |     35 batches | lr 1e-05 | ms/batch 3784.67 | loss  1.54 | ppl     4.657
| epoch 122 step    32200 |    135 batches | lr 1e-05 | ms/batch 3029.02 | loss  4.35 | ppl    77.610
| epoch 122 step    32300 |    235 batches | lr 1e-05 | ms/batch 3028.37 | loss  4.27 | ppl    71.207
----------------------------------------------------------------------------------------------------
| Eval 122 at step    32330 | time: 878.54s | valid loss  4.58 | valid ppl    97.715
| Total time: 10768.35s
----------------------------------------------------------------------------------------------------
| epoch 123 step    32400 |     70 batches | lr 1e-05 | ms/batch 3788.30 | loss  3.06 | ppl    21.309
| epoch 123 step    32500 |    170 batches | lr 1e-05 | ms/batch 3027.48 | loss  4.35 | ppl    77.443
----------------------------------------------------------------------------------------------------
| Eval 123 at step    32595 | time: 878.19s | valid loss  4.58 | valid ppl    97.816
| Total time: 11646.83s
----------------------------------------------------------------------------------------------------
| epoch 124 step    32600 |      5 batches | lr 1e-05 | ms/batch 3770.10 | loss  0.23 | ppl     1.254
| epoch 124 step    32700 |    105 batches | lr 1e-05 | ms/batch 3028.66 | loss  4.35 | ppl    77.738
| epoch 124 step    32800 |    205 batches | lr 1e-05 | ms/batch 3028.07 | loss  4.28 | ppl    72.263
----------------------------------------------------------------------------------------------------
| Eval 124 at step    32860 | time: 876.72s | valid loss  4.58 | valid ppl    97.064
| Total time: 12523.85s
----------------------------------------------------------------------------------------------------
| epoch 125 step    32900 |     40 batches | lr 1e-05 | ms/batch 3786.45 | loss  1.76 | ppl     5.793
| epoch 125 step    33000 |    140 batches | lr 1e-05 | ms/batch 3029.46 | loss  4.34 | ppl    76.877
| epoch 125 step    33100 |    240 batches | lr 1e-05 | ms/batch 3028.91 | loss  4.27 | ppl    71.480
----------------------------------------------------------------------------------------------------
| Eval 125 at step    33125 | time: 879.44s | valid loss  4.57 | valid ppl    96.970
| Total time: 13403.63s
----------------------------------------------------------------------------------------------------
| epoch 126 step    33200 |     75 batches | lr 1e-05 | ms/batch 3796.00 | loss  3.28 | ppl    26.600
| epoch 126 step    33300 |    175 batches | lr 1e-05 | ms/batch 3028.89 | loss  4.33 | ppl    76.162
----------------------------------------------------------------------------------------------------
| Eval 126 at step    33390 | time: 878.41s | valid loss  4.57 | valid ppl    96.709
| Total time: 14282.37s
----------------------------------------------------------------------------------------------------
| epoch 127 step    33400 |     10 batches | lr 1e-05 | ms/batch 3786.47 | loss  0.45 | ppl     1.565
| epoch 127 step    33500 |    110 batches | lr 1e-05 | ms/batch 3028.66 | loss  4.35 | ppl    77.654
| epoch 127 step    33600 |    210 batches | lr 1e-05 | ms/batch 3028.56 | loss  4.28 | ppl    72.318
----------------------------------------------------------------------------------------------------
| Eval 127 at step    33655 | time: 878.23s | valid loss  4.57 | valid ppl    96.678
| Total time: 15160.83s
----------------------------------------------------------------------------------------------------
| epoch 128 step    33700 |     45 batches | lr 1e-05 | ms/batch 3785.02 | loss  1.97 | ppl     7.185
| epoch 128 step    33800 |    145 batches | lr 1e-05 | ms/batch 3028.35 | loss  4.33 | ppl    75.935
| epoch 128 step    33900 |    245 batches | lr 1e-05 | ms/batch 3028.56 | loss  4.26 | ppl    70.822
----------------------------------------------------------------------------------------------------
| Eval 128 at step    33920 | time: 878.19s | valid loss  4.57 | valid ppl    96.692
| Total time: 16039.34s
----------------------------------------------------------------------------------------------------
====================================================================================================
| End of training | test loss  4.51 | test ppl    90.933
| Maximum memory usage: 5569.32MB
====================================================================================================
