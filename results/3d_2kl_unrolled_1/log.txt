|Basic Memory Usage: 8.69MB current, 8.69MB max
====================================================================================================
    - data : ../data/penn/
    - dataset : ptb
    - n_layer : 3
    - d_embed : 400
    - nhid : 1000
    - nout : 400
    - epochs : 500
    - halt_ppl : None
    - time_limit : 16000.0
    - optim : Adam
    - lr : 0.01
    - clip : 0.225
    - batch_size : 32
    - batch_chunk : 1
    - seq_len : 110
    - subseq_len : 55
    - dropout : 0.45
    - dropouti : 0.45
    - wdrop : 0.5
    - emb_dropout : 0.1
    - dropouth : 0.28
    - weight_decay : 1.2e-06
    - wnorm : True
    - seed : 100
    - cuda : True
    - not_tied : False
    - anneal : 10
    - log_interval : 100
    - when : [-1]
    - ksize : 2
    - dilation : 1
    - n_experts : 0
    - multi_gpu : False
    - use_gpus : None
    - f_thres : 45
    - b_thres : 45
    - work_dir : LM-TREdeq-ptb/3d_2kl_unrolled_1_20210512-132834
    - restart : False
    - restart_dir : 
    - debug : False
    - gpu0_bsz : 7
    - pretrain_steps : 2000
    - start_train_steps : 0
    - timing : True
    - eval_mem : False
    - eval : False
    - load : 
    - name : 3d_2kl_unrolled_1
    - tied : True
    - n_token : 10000
    - n_all_param : 24193603
====================================================================================================
#params = 24193603
|Static Memory Usage: 252.25MB current, 269.03MB max
| epoch   1 step      100 |    100 batches | lr 0.01 | ms/batch 105.24 | loss  6.40 | ppl   600.766
| epoch   1 step      200 |    200 batches | lr 0.01 | ms/batch 95.00 | loss  5.75 | ppl   313.871
----------------------------------------------------------------------------------------------------
| Eval   1 at step      265 | time: 27.23s | valid loss  5.35 | valid ppl   211.329
| Total time: 26.50s
----------------------------------------------------------------------------------------------------
| epoch   2 step      300 |     35 batches | lr 0.01 | ms/batch 118.74 | loss  1.96 | ppl     7.086
| epoch   2 step      400 |    135 batches | lr 0.01 | ms/batch 95.01 | loss  5.48 | ppl   238.981
| epoch   2 step      500 |    235 batches | lr 0.01 | ms/batch 95.01 | loss  5.36 | ppl   213.287
----------------------------------------------------------------------------------------------------
| Eval   2 at step      530 | time: 27.55s | valid loss  5.13 | valid ppl   169.431
| Total time: 54.04s
----------------------------------------------------------------------------------------------------
| epoch   3 step      600 |     70 batches | lr 0.01 | ms/batch 120.62 | loss  3.73 | ppl    41.589
| epoch   3 step      700 |    170 batches | lr 0.01 | ms/batch 95.10 | loss  5.28 | ppl   196.800
----------------------------------------------------------------------------------------------------
| Eval   3 at step      795 | time: 27.74s | valid loss  5.02 | valid ppl   151.030
| Total time: 81.73s
----------------------------------------------------------------------------------------------------
| epoch   4 step      800 |      5 batches | lr 0.01 | ms/batch 120.22 | loss  0.27 | ppl     1.311
| epoch   4 step      900 |    105 batches | lr 0.01 | ms/batch 95.08 | loss  5.21 | ppl   182.260
| epoch   4 step     1000 |    205 batches | lr 0.01 | ms/batch 95.05 | loss  5.13 | ppl   168.972
----------------------------------------------------------------------------------------------------
| Eval   4 at step     1060 | time: 27.71s | valid loss  4.95 | valid ppl   141.245
| Total time: 109.39s
----------------------------------------------------------------------------------------------------
| epoch   5 step     1100 |     40 batches | lr 0.01 | ms/batch 120.51 | loss  2.06 | ppl     7.868
| epoch   5 step     1200 |    140 batches | lr 0.01 | ms/batch 95.56 | loss  5.11 | ppl   165.158
| epoch   5 step     1300 |    240 batches | lr 0.01 | ms/batch 95.49 | loss  5.04 | ppl   154.672
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1325 | time: 27.84s | valid loss  4.91 | valid ppl   134.999
| Total time: 137.18s
----------------------------------------------------------------------------------------------------
| epoch   6 step     1400 |     75 batches | lr 0.01 | ms/batch 120.41 | loss  3.81 | ppl    44.963
| epoch   6 step     1500 |    175 batches | lr 0.01 | ms/batch 95.14 | loss  5.04 | ppl   154.894
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1590 | time: 27.72s | valid loss  4.88 | valid ppl   131.300
| Total time: 164.86s
----------------------------------------------------------------------------------------------------
| epoch   7 step     1600 |     10 batches | lr 0.01 | ms/batch 120.12 | loss  0.52 | ppl     1.680
| epoch   7 step     1700 |    110 batches | lr 0.01 | ms/batch 95.12 | loss  5.02 | ppl   151.801
| epoch   7 step     1800 |    210 batches | lr 0.01 | ms/batch 95.08 | loss  4.97 | ppl   143.915
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1855 | time: 27.71s | valid loss  4.86 | valid ppl   129.466
| Total time: 192.52s
----------------------------------------------------------------------------------------------------
| epoch   8 step     1900 |     45 batches | lr 0.01 | ms/batch 120.54 | loss  2.26 | ppl     9.580
| epoch   8 step     2000 |    145 batches | lr 0.01 | ms/batch 95.11 | loss  4.98 | ppl   145.370
| epoch   8 step     2100 |    245 batches | lr 0.01 | ms/batch 3031.10 | loss  4.88 | ppl   131.078
----------------------------------------------------------------------------------------------------
| Eval   8 at step     2120 | time: 452.49s | valid loss  5.48 | valid ppl   239.257
| Total time: 644.97s
----------------------------------------------------------------------------------------------------
| epoch   9 step     2200 |     80 batches | lr 0.01 | ms/batch 3755.89 | loss  4.05 | ppl    57.362
| epoch   9 step     2300 |    180 batches | lr 0.01 | ms/batch 3019.14 | loss  5.01 | ppl   149.576
----------------------------------------------------------------------------------------------------
| Eval   9 at step     2385 | time: 873.72s | valid loss  4.79 | valid ppl   120.480
| Total time: 1518.78s
----------------------------------------------------------------------------------------------------
| epoch  10 step     2400 |     15 batches | lr 0.01 | ms/batch 3770.57 | loss  0.76 | ppl     2.140
| epoch  10 step     2500 |    115 batches | lr 0.01 | ms/batch 3019.09 | loss  4.95 | ppl   140.556
| epoch  10 step     2600 |    215 batches | lr 0.01 | ms/batch 3020.27 | loss  4.87 | ppl   130.096
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2650 | time: 875.49s | valid loss  4.75 | valid ppl   115.151
| Total time: 2394.29s
----------------------------------------------------------------------------------------------------
| epoch  11 step     2700 |     50 batches | lr 0.01 | ms/batch 3772.97 | loss  2.45 | ppl    11.598
| epoch  11 step     2800 |    150 batches | lr 0.01 | ms/batch 3020.97 | loss  4.86 | ppl   128.445
| epoch  11 step     2900 |    250 batches | lr 0.01 | ms/batch 3020.80 | loss  4.79 | ppl   120.473
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2915 | time: 875.73s | valid loss  4.69 | valid ppl   108.928
| Total time: 3270.06s
----------------------------------------------------------------------------------------------------
| epoch  12 step     3000 |     85 batches | lr 0.01 | ms/batch 3773.41 | loss  4.10 | ppl    60.077
| epoch  12 step     3100 |    185 batches | lr 0.01 | ms/batch 3020.54 | loss  4.78 | ppl   119.651
----------------------------------------------------------------------------------------------------
| Eval  12 at step     3180 | time: 875.96s | valid loss  4.67 | valid ppl   106.848
| Total time: 4146.00s
----------------------------------------------------------------------------------------------------
| epoch  13 step     3200 |     20 batches | lr 0.01 | ms/batch 3775.38 | loss  0.97 | ppl     2.637
| epoch  13 step     3300 |    120 batches | lr 0.01 | ms/batch 3020.99 | loss  4.80 | ppl   120.960
| epoch  13 step     3400 |    220 batches | lr 0.01 | ms/batch 3022.40 | loss  4.72 | ppl   112.155
----------------------------------------------------------------------------------------------------
| Eval  13 at step     3445 | time: 876.11s | valid loss  4.71 | valid ppl   110.920
| Total time: 5022.11s
----------------------------------------------------------------------------------------------------
| epoch  14 step     3500 |     55 batches | lr 0.01 | ms/batch 3759.79 | loss  2.61 | ppl    13.606
| epoch  14 step     3600 |    155 batches | lr 0.01 | ms/batch 3021.22 | loss  4.76 | ppl   117.074
| epoch  14 step     3700 |    255 batches | lr 0.01 | ms/batch 3021.09 | loss  4.71 | ppl   110.620
----------------------------------------------------------------------------------------------------
| Eval  14 at step     3710 | time: 874.36s | valid loss  4.63 | valid ppl   102.585
| Total time: 5896.55s
----------------------------------------------------------------------------------------------------
| epoch  15 step     3800 |     90 batches | lr 0.01 | ms/batch 3774.04 | loss  4.27 | ppl    71.378
| epoch  15 step     3900 |    190 batches | lr 0.01 | ms/batch 3021.04 | loss  4.69 | ppl   108.923
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3975 | time: 876.14s | valid loss  4.63 | valid ppl   102.819
| Total time: 6772.65s
----------------------------------------------------------------------------------------------------
| epoch  16 step     4000 |     25 batches | lr 0.01 | ms/batch 3761.27 | loss  1.18 | ppl     3.268
| epoch  16 step     4100 |    125 batches | lr 0.01 | ms/batch 3021.17 | loss  4.73 | ppl   113.218
| epoch  16 step     4200 |    225 batches | lr 0.01 | ms/batch 3021.07 | loss  4.66 | ppl   105.122
----------------------------------------------------------------------------------------------------
| Eval  16 at step     4240 | time: 874.35s | valid loss  4.62 | valid ppl   101.072
| Total time: 7647.09s
----------------------------------------------------------------------------------------------------
| epoch  17 step     4300 |     60 batches | lr 0.01 | ms/batch 3773.62 | loss  2.81 | ppl    16.665
| epoch  17 step     4400 |    160 batches | lr 0.01 | ms/batch 3020.75 | loss  4.71 | ppl   110.980
| epoch  17 step     4500 |    260 batches | lr 0.01 | ms/batch 3020.65 | loss  4.65 | ppl   104.978
----------------------------------------------------------------------------------------------------
| Eval  17 at step     4505 | time: 875.86s | valid loss  4.61 | valid ppl   100.005
| Total time: 8523.16s
----------------------------------------------------------------------------------------------------
| epoch  18 step     4600 |     95 batches | lr 0.01 | ms/batch 3774.88 | loss  4.46 | ppl    86.496
| epoch  18 step     4700 |    195 batches | lr 0.01 | ms/batch 3020.59 | loss  4.63 | ppl   102.454
----------------------------------------------------------------------------------------------------
| Eval  18 at step     4770 | time: 875.98s | valid loss  4.61 | valid ppl   100.480
| Total time: 9399.51s
----------------------------------------------------------------------------------------------------
| epoch  19 step     4800 |     30 batches | lr 0.01 | ms/batch 3760.00 | loss  1.41 | ppl     4.088
| epoch  19 step     4900 |    130 batches | lr 0.01 | ms/batch 3022.76 | loss  4.67 | ppl   106.646
| epoch  19 step     5000 |    230 batches | lr 0.01 | ms/batch 3022.67 | loss  4.62 | ppl   101.457
----------------------------------------------------------------------------------------------------
| Eval  19 at step     5035 | time: 874.83s | valid loss  4.60 | valid ppl    99.947
| Total time: 10274.72s
----------------------------------------------------------------------------------------------------
| epoch  20 step     5100 |     65 batches | lr 0.01 | ms/batch 3776.03 | loss  3.03 | ppl    20.685
| epoch  20 step     5200 |    165 batches | lr 0.01 | ms/batch 3022.79 | loss  4.67 | ppl   106.678
| epoch  20 step     5300 |    265 batches | lr 0.01 | ms/batch 2996.19 | loss  4.61 | ppl   100.190
----------------------------------------------------------------------------------------------------
| Eval  20 at step     5300 | time: 876.36s | valid loss  4.60 | valid ppl    99.063
| Total time: 11151.45s
----------------------------------------------------------------------------------------------------
| epoch  21 step     5400 |    100 batches | lr 0.01 | ms/batch 3803.66 | loss  4.66 | ppl   105.167
| epoch  21 step     5500 |    200 batches | lr 0.01 | ms/batch 3022.89 | loss  4.60 | ppl    99.497
----------------------------------------------------------------------------------------------------
| Eval  21 at step     5565 | time: 876.63s | valid loss  4.58 | valid ppl    97.742
| Total time: 12028.46s
----------------------------------------------------------------------------------------------------
| epoch  22 step     5600 |     35 batches | lr 0.01 | ms/batch 3777.83 | loss  1.63 | ppl     5.113
| epoch  22 step     5700 |    135 batches | lr 0.01 | ms/batch 3020.92 | loss  4.63 | ppl   103.011
| epoch  22 step     5800 |    235 batches | lr 0.01 | ms/batch 3021.31 | loss  4.58 | ppl    97.876
----------------------------------------------------------------------------------------------------
| Eval  22 at step     5830 | time: 876.13s | valid loss  4.63 | valid ppl   102.732
| Total time: 12904.96s
----------------------------------------------------------------------------------------------------
| epoch  23 step     5900 |     70 batches | lr 0.01 | ms/batch 3761.40 | loss  3.23 | ppl    25.286
| epoch  23 step     6000 |    170 batches | lr 0.01 | ms/batch 3021.72 | loss  4.64 | ppl   103.497
----------------------------------------------------------------------------------------------------
| Eval  23 at step     6095 | time: 874.55s | valid loss  4.60 | valid ppl    99.696
| Total time: 13779.87s
----------------------------------------------------------------------------------------------------
| epoch  24 step     6100 |      5 batches | lr 0.01 | ms/batch 3759.57 | loss  0.24 | ppl     1.275
| epoch  24 step     6200 |    105 batches | lr 0.01 | ms/batch 3020.82 | loss  4.62 | ppl   101.893
| epoch  24 step     6300 |    205 batches | lr 0.01 | ms/batch 3020.59 | loss  4.57 | ppl    96.416
----------------------------------------------------------------------------------------------------
| Eval  24 at step     6360 | time: 874.49s | valid loss  4.59 | valid ppl    98.854
| Total time: 14654.73s
----------------------------------------------------------------------------------------------------
| epoch  25 step     6400 |     40 batches | lr 0.01 | ms/batch 3760.63 | loss  1.86 | ppl     6.411
| epoch  25 step     6500 |    140 batches | lr 0.01 | ms/batch 3020.04 | loss  4.61 | ppl   100.124
| epoch  25 step     6600 |    240 batches | lr 0.01 | ms/batch 3021.02 | loss  4.56 | ppl    96.008
----------------------------------------------------------------------------------------------------
| Eval  25 at step     6625 | time: 874.58s | valid loss  4.57 | valid ppl    96.139
| Total time: 15529.64s
----------------------------------------------------------------------------------------------------
| epoch  26 step     6700 |     75 batches | lr 0.01 | ms/batch 3776.68 | loss  3.45 | ppl    31.646
| epoch  26 step     6800 |    175 batches | lr 0.01 | ms/batch 3020.69 | loss  4.60 | ppl    99.333
----------------------------------------------------------------------------------------------------
| Eval  26 at step     6890 | time: 875.98s | valid loss  4.55 | valid ppl    94.923
| Total time: 16406.03s
----------------------------------------------------------------------------------------------------
====================================================================================================
| End of training | test loss  4.55 | test ppl    94.757
| Maximum memory usage: 5569.32MB
====================================================================================================
