|Basic Memory Usage: 8.69MB current, 8.69MB max
====================================================================================================
    - data : ../data/penn/
    - dataset : ptb
    - n_layer : 40
    - d_embed : 400
    - nhid : 1000
    - nout : 400
    - epochs : 500
    - halt_ppl : None
    - time_limit : 16000.0
    - optim : Adam
    - lr : 0.01
    - clip : 0.225
    - batch_size : 32
    - batch_chunk : 1
    - seq_len : 110
    - subseq_len : 55
    - dropout : 0.45
    - dropouti : 0.45
    - wdrop : 0.5
    - emb_dropout : 0.1
    - dropouth : 0.28
    - weight_decay : 1.2e-06
    - wnorm : True
    - seed : 100
    - cuda : True
    - not_tied : False
    - anneal : 10
    - log_interval : 100
    - when : [-1]
    - ksize : 2
    - dilation : 1
    - n_experts : 0
    - multi_gpu : False
    - use_gpus : None
    - f_thres : 45
    - b_thres : 45
    - work_dir : LM-TREdeq-ptb/40d_2kl_unrolled_1_20210512-132859
    - restart : False
    - restart_dir : 
    - debug : False
    - gpu0_bsz : 7
    - pretrain_steps : 2000
    - start_train_steps : 0
    - timing : True
    - eval_mem : False
    - eval : False
    - load : 
    - name : 40d_2kl_unrolled_1
    - tied : True
    - n_token : 10000
    - n_all_param : 24193603
====================================================================================================
#params = 24193603
|Static Memory Usage: 252.25MB current, 269.03MB max
| epoch   1 step      100 |    100 batches | lr 0.01 | ms/batch 1100.86 | loss  6.43 | ppl   618.622
| epoch   1 step      200 |    200 batches | lr 0.01 | ms/batch 1094.59 | loss  5.81 | ppl   331.986
----------------------------------------------------------------------------------------------------
| Eval   1 at step      265 | time: 299.84s | valid loss  5.38 | valid ppl   217.845
| Total time: 299.56s
----------------------------------------------------------------------------------------------------
| epoch   2 step      300 |     35 batches | lr 0.01 | ms/batch 1199.38 | loss  1.97 | ppl     7.154
| epoch   2 step      400 |    135 batches | lr 0.01 | ms/batch 1094.46 | loss  5.50 | ppl   245.606
| epoch   2 step      500 |    235 batches | lr 0.01 | ms/batch 1094.43 | loss  5.39 | ppl   218.636
----------------------------------------------------------------------------------------------------
| Eval   2 at step      530 | time: 300.52s | valid loss  5.13 | valid ppl   168.366
| Total time: 600.18s
----------------------------------------------------------------------------------------------------
| epoch   3 step      600 |     70 batches | lr 0.01 | ms/batch 1201.57 | loss  3.73 | ppl    41.772
| epoch   3 step      700 |    170 batches | lr 0.01 | ms/batch 1094.72 | loss  5.27 | ppl   194.671
----------------------------------------------------------------------------------------------------
| Eval   3 at step      795 | time: 300.84s | valid loss  4.97 | valid ppl   144.515
| Total time: 901.05s
----------------------------------------------------------------------------------------------------
| epoch   4 step      800 |      5 batches | lr 0.01 | ms/batch 1202.04 | loss  0.27 | ppl     1.310
| epoch   4 step      900 |    105 batches | lr 0.01 | ms/batch 1094.84 | loss  5.18 | ppl   177.142
| epoch   4 step     1000 |    205 batches | lr 0.01 | ms/batch 1094.57 | loss  5.10 | ppl   163.246
----------------------------------------------------------------------------------------------------
| Eval   4 at step     1060 | time: 300.82s | valid loss  4.88 | valid ppl   132.145
| Total time: 1201.91s
----------------------------------------------------------------------------------------------------
| epoch   5 step     1100 |     40 batches | lr 0.01 | ms/batch 1202.34 | loss  2.04 | ppl     7.718
| epoch   5 step     1200 |    140 batches | lr 0.01 | ms/batch 1094.76 | loss  5.05 | ppl   156.179
| epoch   5 step     1300 |    240 batches | lr 0.01 | ms/batch 1094.63 | loss  4.98 | ppl   145.662
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1325 | time: 300.82s | valid loss  4.82 | valid ppl   123.552
| Total time: 1502.76s
----------------------------------------------------------------------------------------------------
| epoch   6 step     1400 |     75 batches | lr 0.01 | ms/batch 1201.67 | loss  3.75 | ppl    42.599
| epoch   6 step     1500 |    175 batches | lr 0.01 | ms/batch 1094.73 | loss  4.96 | ppl   142.367
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1590 | time: 300.84s | valid loss  4.77 | valid ppl   117.753
| Total time: 1803.64s
----------------------------------------------------------------------------------------------------
| epoch   7 step     1600 |     10 batches | lr 0.01 | ms/batch 1202.39 | loss  0.51 | ppl     1.667
| epoch   7 step     1700 |    110 batches | lr 0.01 | ms/batch 1094.92 | loss  4.93 | ppl   137.793
| epoch   7 step     1800 |    210 batches | lr 0.01 | ms/batch 1094.86 | loss  4.87 | ppl   130.379
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1855 | time: 300.95s | valid loss  4.74 | valid ppl   114.890
| Total time: 2104.63s
----------------------------------------------------------------------------------------------------
| epoch   8 step     1900 |     45 batches | lr 0.01 | ms/batch 1203.33 | loss  2.21 | ppl     9.149
| epoch   8 step     2000 |    145 batches | lr 0.01 | ms/batch 1094.93 | loss  4.87 | ppl   130.084
| epoch   8 step     2100 |    245 batches | lr 0.01 | ms/batch 3025.75 | loss  4.85 | ppl   127.584
----------------------------------------------------------------------------------------------------
| Eval   8 at step     2120 | time: 597.02s | valid loss  4.84 | valid ppl   126.145
| Total time: 2701.70s
----------------------------------------------------------------------------------------------------
| epoch   9 step     2200 |     80 batches | lr 0.01 | ms/batch 3754.30 | loss  4.04 | ppl    56.613
| epoch   9 step     2300 |    180 batches | lr 0.01 | ms/batch 3017.26 | loss  4.94 | ppl   139.106
----------------------------------------------------------------------------------------------------
| Eval   9 at step     2385 | time: 873.48s | valid loss  4.74 | valid ppl   114.917
| Total time: 3575.46s
----------------------------------------------------------------------------------------------------
| epoch  10 step     2400 |     15 batches | lr 0.01 | ms/batch 3756.44 | loss  0.74 | ppl     2.103
| epoch  10 step     2500 |    115 batches | lr 0.01 | ms/batch 3018.33 | loss  4.90 | ppl   134.058
| epoch  10 step     2600 |    215 batches | lr 0.01 | ms/batch 3018.51 | loss  4.80 | ppl   121.227
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2650 | time: 873.66s | valid loss  4.71 | valid ppl   111.478
| Total time: 4449.42s
----------------------------------------------------------------------------------------------------
| epoch  11 step     2700 |     50 batches | lr 0.01 | ms/batch 3772.74 | loss  2.43 | ppl    11.402
| epoch  11 step     2800 |    150 batches | lr 0.01 | ms/batch 3021.40 | loss  4.85 | ppl   127.206
| epoch  11 step     2900 |    250 batches | lr 0.01 | ms/batch 3022.29 | loss  4.77 | ppl   118.122
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2915 | time: 876.06s | valid loss  4.69 | valid ppl   108.601
| Total time: 5325.71s
----------------------------------------------------------------------------------------------------
| epoch  12 step     3000 |     85 batches | lr 0.01 | ms/batch 3773.66 | loss  4.09 | ppl    59.805
| epoch  12 step     3100 |    185 batches | lr 0.01 | ms/batch 3019.26 | loss  4.78 | ppl   118.885
----------------------------------------------------------------------------------------------------
| Eval  12 at step     3180 | time: 875.70s | valid loss  4.69 | valid ppl   108.983
| Total time: 6201.63s
----------------------------------------------------------------------------------------------------
| epoch  13 step     3200 |     20 batches | lr 0.01 | ms/batch 3759.41 | loss  0.97 | ppl     2.643
| epoch  13 step     3300 |    120 batches | lr 0.01 | ms/batch 3020.00 | loss  4.81 | ppl   122.166
| epoch  13 step     3400 |    220 batches | lr 0.01 | ms/batch 3020.32 | loss  4.72 | ppl   112.273
----------------------------------------------------------------------------------------------------
| Eval  13 at step     3445 | time: 874.28s | valid loss  4.67 | valid ppl   107.188
| Total time: 7076.19s
----------------------------------------------------------------------------------------------------
| epoch  14 step     3500 |     55 batches | lr 0.01 | ms/batch 3774.18 | loss  2.62 | ppl    13.804
| epoch  14 step     3600 |    155 batches | lr 0.01 | ms/batch 3020.48 | loss  4.77 | ppl   117.541
| epoch  14 step     3700 |    255 batches | lr 0.01 | ms/batch 3020.20 | loss  4.72 | ppl   112.462
----------------------------------------------------------------------------------------------------
| Eval  14 at step     3710 | time: 875.79s | valid loss  4.65 | valid ppl   105.106
| Total time: 7951.99s
----------------------------------------------------------------------------------------------------
| epoch  15 step     3800 |     90 batches | lr 0.01 | ms/batch 3775.33 | loss  4.29 | ppl    72.863
| epoch  15 step     3900 |    190 batches | lr 0.01 | ms/batch 3021.78 | loss  4.70 | ppl   109.743
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3975 | time: 876.12s | valid loss  4.65 | valid ppl   105.028
| Total time: 8828.12s
----------------------------------------------------------------------------------------------------
| epoch  16 step     4000 |     25 batches | lr 0.01 | ms/batch 3775.85 | loss  1.19 | ppl     3.286
| epoch  16 step     4100 |    125 batches | lr 0.01 | ms/batch 3021.06 | loss  4.76 | ppl   116.953
| epoch  16 step     4200 |    225 batches | lr 0.01 | ms/batch 3021.63 | loss  4.67 | ppl   107.226
----------------------------------------------------------------------------------------------------
| Eval  16 at step     4240 | time: 876.00s | valid loss  4.64 | valid ppl   104.034
| Total time: 9704.14s
----------------------------------------------------------------------------------------------------
| epoch  17 step     4300 |     60 batches | lr 0.01 | ms/batch 3774.89 | loss  2.83 | ppl    17.026
| epoch  17 step     4400 |    160 batches | lr 0.01 | ms/batch 3021.93 | loss  4.73 | ppl   113.484
| epoch  17 step     4500 |    260 batches | lr 0.01 | ms/batch 3021.77 | loss  4.68 | ppl   108.083
----------------------------------------------------------------------------------------------------
| Eval  17 at step     4505 | time: 876.40s | valid loss  4.64 | valid ppl   103.284
| Total time: 10580.53s
----------------------------------------------------------------------------------------------------
| epoch  18 step     4600 |     95 batches | lr 0.01 | ms/batch 3779.34 | loss  4.49 | ppl    89.435
| epoch  18 step     4700 |    195 batches | lr 0.01 | ms/batch 3021.62 | loss  4.66 | ppl   105.237
----------------------------------------------------------------------------------------------------
| Eval  18 at step     4770 | time: 876.26s | valid loss  4.64 | valid ppl   103.227
| Total time: 11456.65s
----------------------------------------------------------------------------------------------------
| epoch  19 step     4800 |     30 batches | lr 0.01 | ms/batch 3775.31 | loss  1.42 | ppl     4.131
| epoch  19 step     4900 |    130 batches | lr 0.01 | ms/batch 3022.16 | loss  4.70 | ppl   110.481
| epoch  19 step     5000 |    230 batches | lr 0.01 | ms/batch 3022.00 | loss  4.66 | ppl   105.545
----------------------------------------------------------------------------------------------------
| Eval  19 at step     5035 | time: 876.43s | valid loss  4.62 | valid ppl   101.479
| Total time: 12333.05s
----------------------------------------------------------------------------------------------------
| epoch  20 step     5100 |     65 batches | lr 0.01 | ms/batch 3776.98 | loss  3.05 | ppl    21.150
| epoch  20 step     5200 |    165 batches | lr 0.01 | ms/batch 3021.58 | loss  4.71 | ppl   110.616
| epoch  20 step     5300 |    265 batches | lr 0.01 | ms/batch 2994.90 | loss  4.65 | ppl   104.323
----------------------------------------------------------------------------------------------------
| Eval  20 at step     5300 | time: 876.02s | valid loss  4.62 | valid ppl   101.646
| Total time: 13209.14s
----------------------------------------------------------------------------------------------------
| epoch  21 step     5400 |    100 batches | lr 0.01 | ms/batch 3787.39 | loss  4.70 | ppl   109.451
| epoch  21 step     5500 |    200 batches | lr 0.01 | ms/batch 3021.45 | loss  4.64 | ppl   103.732
----------------------------------------------------------------------------------------------------
| Eval  21 at step     5565 | time: 874.70s | valid loss  4.61 | valid ppl   100.469
| Total time: 14083.78s
----------------------------------------------------------------------------------------------------
| epoch  22 step     5600 |     35 batches | lr 0.01 | ms/batch 3775.79 | loss  1.64 | ppl     5.169
| epoch  22 step     5700 |    135 batches | lr 0.01 | ms/batch 3021.29 | loss  4.68 | ppl   107.516
| epoch  22 step     5800 |    235 batches | lr 0.01 | ms/batch 3021.33 | loss  4.63 | ppl   102.073
----------------------------------------------------------------------------------------------------
| Eval  22 at step     5830 | time: 876.01s | valid loss  4.60 | valid ppl    99.853
| Total time: 14959.62s
----------------------------------------------------------------------------------------------------
| epoch  23 step     5900 |     70 batches | lr 0.01 | ms/batch 3774.93 | loss  3.27 | ppl    26.313
| epoch  23 step     6000 |    170 batches | lr 0.01 | ms/batch 3021.40 | loss  4.68 | ppl   108.228
----------------------------------------------------------------------------------------------------
| Eval  23 at step     6095 | time: 876.16s | valid loss  4.60 | valid ppl    99.793
| Total time: 15835.77s
----------------------------------------------------------------------------------------------------
| epoch  24 step     6100 |      5 batches | lr 0.01 | ms/batch 3776.62 | loss  0.25 | ppl     1.280
| epoch  24 step     6200 |    105 batches | lr 0.01 | ms/batch 3020.56 | loss  4.67 | ppl   107.042
| epoch  24 step     6300 |    205 batches | lr 0.01 | ms/batch 3020.73 | loss  4.62 | ppl   101.578
----------------------------------------------------------------------------------------------------
| Eval  24 at step     6360 | time: 876.05s | valid loss  4.60 | valid ppl    99.200
| Total time: 16711.85s
----------------------------------------------------------------------------------------------------
====================================================================================================
| End of training | test loss  4.56 | test ppl    95.630
| Maximum memory usage: 6574.60MB
====================================================================================================
