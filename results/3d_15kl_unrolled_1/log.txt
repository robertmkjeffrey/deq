|Basic Memory Usage: 8.69MB current, 8.69MB max
====================================================================================================
    - data : ../data/penn/
    - dataset : ptb
    - n_layer : 3
    - d_embed : 400
    - nhid : 1000
    - nout : 400
    - epochs : 500
    - halt_ppl : None
    - time_limit : 16000.0
    - optim : Adam
    - lr : 0.01
    - clip : 0.225
    - batch_size : 32
    - batch_chunk : 1
    - seq_len : 110
    - subseq_len : 55
    - dropout : 0.45
    - dropouti : 0.45
    - wdrop : 0.5
    - emb_dropout : 0.1
    - dropouth : 0.28
    - weight_decay : 1.2e-06
    - wnorm : True
    - seed : 100
    - cuda : True
    - not_tied : False
    - anneal : 10
    - log_interval : 100
    - when : [-1]
    - ksize : 2
    - dilation : 1
    - n_experts : 0
    - multi_gpu : False
    - use_gpus : None
    - f_thres : 45
    - b_thres : 45
    - work_dir : LM-TREdeq-ptb/20210508-005528
    - restart : False
    - restart_dir : 
    - debug : False
    - gpu0_bsz : 7
    - pretrain_steps : 15000
    - start_train_steps : 0
    - timing : True
    - eval_mem : False
    - eval : False
    - load : 
    - name : 3d_15kl_unrolled_1.sh
    - tied : True
    - n_token : 10000
    - n_all_param : 24193603
====================================================================================================
#params = 24193603
|Static Memory Usage: 252.25MB current, 269.03MB max
| epoch   1 step      100 |    100 batches | lr 0.01 | ms/batch 100.55 | loss  6.40 | ppl   600.766
| epoch   1 step      200 |    200 batches | lr 0.01 | ms/batch 95.54 | loss  5.75 | ppl   313.871
----------------------------------------------------------------------------------------------------
| Eval   1 at step      265 | time: 26.89s | valid loss  5.35 | valid ppl   211.329
| Total time: 26.65s
----------------------------------------------------------------------------------------------------
| epoch   2 step      300 |     35 batches | lr 0.01 | ms/batch 126.68 | loss  1.96 | ppl     7.086
| epoch   2 step      400 |    135 batches | lr 0.01 | ms/batch 95.56 | loss  5.48 | ppl   238.981
| epoch   2 step      500 |    235 batches | lr 0.01 | ms/batch 95.57 | loss  5.36 | ppl   213.287
----------------------------------------------------------------------------------------------------
| Eval   2 at step      530 | time: 28.41s | valid loss  5.13 | valid ppl   169.431
| Total time: 54.50s
----------------------------------------------------------------------------------------------------
| epoch   3 step      600 |     70 batches | lr 0.01 | ms/batch 124.85 | loss  3.73 | ppl    41.589
| epoch   3 step      700 |    170 batches | lr 0.01 | ms/batch 95.56 | loss  5.28 | ppl   196.800
----------------------------------------------------------------------------------------------------
| Eval   3 at step      795 | time: 28.27s | valid loss  5.02 | valid ppl   151.030
| Total time: 82.24s
----------------------------------------------------------------------------------------------------
| epoch   4 step      800 |      5 batches | lr 0.01 | ms/batch 126.51 | loss  0.27 | ppl     1.311
| epoch   4 step      900 |    105 batches | lr 0.01 | ms/batch 95.54 | loss  5.21 | ppl   182.260
| epoch   4 step     1000 |    205 batches | lr 0.01 | ms/batch 95.50 | loss  5.13 | ppl   168.972
----------------------------------------------------------------------------------------------------
| Eval   4 at step     1060 | time: 28.41s | valid loss  4.95 | valid ppl   141.245
| Total time: 110.12s
----------------------------------------------------------------------------------------------------
| epoch   5 step     1100 |     40 batches | lr 0.01 | ms/batch 127.40 | loss  2.06 | ppl     7.868
| epoch   5 step     1200 |    140 batches | lr 0.01 | ms/batch 95.57 | loss  5.11 | ppl   165.158
| epoch   5 step     1300 |    240 batches | lr 0.01 | ms/batch 95.51 | loss  5.04 | ppl   154.672
----------------------------------------------------------------------------------------------------
| Eval   5 at step     1325 | time: 28.51s | valid loss  4.91 | valid ppl   134.999
| Total time: 137.91s
----------------------------------------------------------------------------------------------------
| epoch   6 step     1400 |     75 batches | lr 0.01 | ms/batch 124.33 | loss  3.81 | ppl    44.963
| epoch   6 step     1500 |    175 batches | lr 0.01 | ms/batch 95.52 | loss  5.04 | ppl   154.894
----------------------------------------------------------------------------------------------------
| Eval   6 at step     1590 | time: 28.14s | valid loss  4.88 | valid ppl   131.300
| Total time: 165.56s
----------------------------------------------------------------------------------------------------
| epoch   7 step     1600 |     10 batches | lr 0.01 | ms/batch 126.06 | loss  0.52 | ppl     1.680
| epoch   7 step     1700 |    110 batches | lr 0.01 | ms/batch 95.54 | loss  5.02 | ppl   151.801
| epoch   7 step     1800 |    210 batches | lr 0.01 | ms/batch 95.54 | loss  4.97 | ppl   143.915
----------------------------------------------------------------------------------------------------
| Eval   7 at step     1855 | time: 28.40s | valid loss  4.86 | valid ppl   129.466
| Total time: 193.43s
----------------------------------------------------------------------------------------------------
| epoch   8 step     1900 |     45 batches | lr 0.01 | ms/batch 124.83 | loss  2.26 | ppl     9.580
| epoch   8 step     2000 |    145 batches | lr 0.01 | ms/batch 95.24 | loss  4.98 | ppl   145.370
| epoch   8 step     2100 |    245 batches | lr 0.01 | ms/batch 95.57 | loss  4.93 | ppl   138.748
----------------------------------------------------------------------------------------------------
| Eval   8 at step     2120 | time: 28.25s | valid loss  4.85 | valid ppl   127.777
| Total time: 221.13s
----------------------------------------------------------------------------------------------------
| epoch   9 step     2200 |     80 batches | lr 0.01 | ms/batch 125.13 | loss  3.97 | ppl    52.940
| epoch   9 step     2300 |    180 batches | lr 0.01 | ms/batch 95.61 | loss  4.93 | ppl   137.952
----------------------------------------------------------------------------------------------------
| Eval   9 at step     2385 | time: 28.28s | valid loss  4.84 | valid ppl   126.718
| Total time: 248.90s
----------------------------------------------------------------------------------------------------
| epoch  10 step     2400 |     15 batches | lr 0.01 | ms/batch 124.35 | loss  0.75 | ppl     2.116
| epoch  10 step     2500 |    115 batches | lr 0.01 | ms/batch 95.51 | loss  4.93 | ppl   139.014
| epoch  10 step     2600 |    215 batches | lr 0.01 | ms/batch 95.55 | loss  4.87 | ppl   130.689
----------------------------------------------------------------------------------------------------
| Eval  10 at step     2650 | time: 28.19s | valid loss  4.83 | valid ppl   125.003
| Total time: 276.58s
----------------------------------------------------------------------------------------------------
| epoch  11 step     2700 |     50 batches | lr 0.01 | ms/batch 129.48 | loss  2.46 | ppl    11.722
| epoch  11 step     2800 |    150 batches | lr 0.01 | ms/batch 95.57 | loss  4.91 | ppl   136.068
| epoch  11 step     2900 |    250 batches | lr 0.01 | ms/batch 95.53 | loss  4.86 | ppl   128.602
----------------------------------------------------------------------------------------------------
| Eval  11 at step     2915 | time: 28.72s | valid loss  4.81 | valid ppl   122.338
| Total time: 304.66s
----------------------------------------------------------------------------------------------------
| epoch  12 step     3000 |     85 batches | lr 0.01 | ms/batch 125.32 | loss  4.16 | ppl    63.772
| epoch  12 step     3100 |    185 batches | lr 0.01 | ms/batch 95.53 | loss  4.87 | ppl   130.126
----------------------------------------------------------------------------------------------------
| Eval  12 at step     3180 | time: 28.29s | valid loss  4.80 | valid ppl   121.236
| Total time: 332.40s
----------------------------------------------------------------------------------------------------
| epoch  13 step     3200 |     20 batches | lr 0.01 | ms/batch 125.55 | loss  0.99 | ppl     2.686
| epoch  13 step     3300 |    120 batches | lr 0.01 | ms/batch 95.52 | loss  4.89 | ppl   132.817
| epoch  13 step     3400 |    220 batches | lr 0.01 | ms/batch 95.53 | loss  4.82 | ppl   123.960
----------------------------------------------------------------------------------------------------
| Eval  13 at step     3445 | time: 28.33s | valid loss  4.79 | valid ppl   120.621
| Total time: 360.17s
----------------------------------------------------------------------------------------------------
| epoch  14 step     3500 |     55 batches | lr 0.01 | ms/batch 124.74 | loss  2.67 | ppl    14.438
| epoch  14 step     3600 |    155 batches | lr 0.01 | ms/batch 95.53 | loss  4.87 | ppl   130.143
| epoch  14 step     3700 |    255 batches | lr 0.01 | ms/batch 95.57 | loss  4.82 | ppl   124.390
----------------------------------------------------------------------------------------------------
| Eval  14 at step     3710 | time: 28.23s | valid loss  4.78 | valid ppl   119.378
| Total time: 387.86s
----------------------------------------------------------------------------------------------------
| epoch  15 step     3800 |     90 batches | lr 0.01 | ms/batch 125.59 | loss  4.37 | ppl    79.312
| epoch  15 step     3900 |    190 batches | lr 0.01 | ms/batch 95.57 | loss  4.81 | ppl   122.990
----------------------------------------------------------------------------------------------------
| Eval  15 at step     3975 | time: 28.33s | valid loss  4.79 | valid ppl   120.136
| Total time: 415.63s
----------------------------------------------------------------------------------------------------
| epoch  16 step     4000 |     25 batches | lr 0.01 | ms/batch 105.97 | loss  1.21 | ppl     3.369
| epoch  16 step     4100 |    125 batches | lr 0.01 | ms/batch 95.59 | loss  4.86 | ppl   129.434
| epoch  16 step     4200 |    225 batches | lr 0.01 | ms/batch 95.52 | loss  4.79 | ppl   120.105
----------------------------------------------------------------------------------------------------
| Eval  16 at step     4240 | time: 26.37s | valid loss  4.78 | valid ppl   119.143
| Total time: 442.01s
----------------------------------------------------------------------------------------------------
| epoch  17 step     4300 |     60 batches | lr 0.01 | ms/batch 127.37 | loss  2.89 | ppl    18.063
| epoch  17 step     4400 |    160 batches | lr 0.01 | ms/batch 95.61 | loss  4.84 | ppl   126.967
| epoch  17 step     4500 |    260 batches | lr 0.01 | ms/batch 95.55 | loss  4.80 | ppl   121.079
----------------------------------------------------------------------------------------------------
| Eval  17 at step     4505 | time: 28.51s | valid loss  4.78 | valid ppl   118.830
| Total time: 470.00s
----------------------------------------------------------------------------------------------------
| epoch  18 step     4600 |     95 batches | lr 0.01 | ms/batch 126.62 | loss  4.59 | ppl    98.962
| epoch  18 step     4700 |    195 batches | lr 0.01 | ms/batch 95.57 | loss  4.77 | ppl   118.321
----------------------------------------------------------------------------------------------------
| Eval  18 at step     4770 | time: 28.41s | valid loss  4.78 | valid ppl   119.289
| Total time: 497.84s
----------------------------------------------------------------------------------------------------
| epoch  19 step     4800 |     30 batches | lr 0.01 | ms/batch 105.63 | loss  1.45 | ppl     4.277
| epoch  19 step     4900 |    130 batches | lr 0.01 | ms/batch 95.20 | loss  4.82 | ppl   123.904
| epoch  19 step     5000 |    230 batches | lr 0.01 | ms/batch 95.47 | loss  4.77 | ppl   118.264
----------------------------------------------------------------------------------------------------
| Eval  19 at step     5035 | time: 26.30s | valid loss  4.77 | valid ppl   117.904
| Total time: 524.16s
----------------------------------------------------------------------------------------------------
| epoch  20 step     5100 |     65 batches | lr 0.01 | ms/batch 126.74 | loss  3.13 | ppl    22.792
| epoch  20 step     5200 |    165 batches | lr 0.01 | ms/batch 95.52 | loss  4.82 | ppl   124.481
| epoch  20 step     5300 |    265 batches | lr 0.01 | ms/batch 94.76 | loss  4.76 | ppl   117.146
----------------------------------------------------------------------------------------------------
| Eval  20 at step     5300 | time: 28.43s | valid loss  4.77 | valid ppl   118.267
| Total time: 552.03s
----------------------------------------------------------------------------------------------------
| epoch  21 step     5400 |    100 batches | lr 0.01 | ms/batch 106.57 | loss  4.81 | ppl   122.822
| epoch  21 step     5500 |    200 batches | lr 0.01 | ms/batch 95.47 | loss  4.77 | ppl   117.750
----------------------------------------------------------------------------------------------------
| Eval  21 at step     5565 | time: 26.35s | valid loss  4.77 | valid ppl   118.389
| Total time: 578.39s
----------------------------------------------------------------------------------------------------
| epoch  22 step     5600 |     35 batches | lr 0.01 | ms/batch 106.00 | loss  1.69 | ppl     5.401
| epoch  22 step     5700 |    135 batches | lr 0.01 | ms/batch 95.52 | loss  4.80 | ppl   122.109
| epoch  22 step     5800 |    235 batches | lr 0.01 | ms/batch 95.53 | loss  4.76 | ppl   116.224
----------------------------------------------------------------------------------------------------
| Eval  22 at step     5830 | time: 26.35s | valid loss  4.78 | valid ppl   118.561
| Total time: 604.75s
----------------------------------------------------------------------------------------------------
| epoch  23 step     5900 |     70 batches | lr 0.01 | ms/batch 105.88 | loss  3.35 | ppl    28.592
| epoch  23 step     6000 |    170 batches | lr 0.01 | ms/batch 95.50 | loss  4.81 | ppl   122.152
----------------------------------------------------------------------------------------------------
| Eval  23 at step     6095 | time: 26.35s | valid loss  4.78 | valid ppl   118.818
| Total time: 631.11s
----------------------------------------------------------------------------------------------------
| epoch  24 step     6100 |      5 batches | lr 0.01 | ms/batch 105.86 | loss  0.25 | ppl     1.285
| epoch  24 step     6200 |    105 batches | lr 0.01 | ms/batch 95.49 | loss  4.80 | ppl   121.131
| epoch  24 step     6300 |    205 batches | lr 0.01 | ms/batch 95.53 | loss  4.75 | ppl   115.786
----------------------------------------------------------------------------------------------------
| Eval  24 at step     6360 | time: 26.36s | valid loss  4.76 | valid ppl   116.637
| Total time: 657.48s
----------------------------------------------------------------------------------------------------
| epoch  25 step     6400 |     40 batches | lr 0.01 | ms/batch 131.67 | loss  1.92 | ppl     6.849
| epoch  25 step     6500 |    140 batches | lr 0.01 | ms/batch 95.49 | loss  4.79 | ppl   119.784
| epoch  25 step     6600 |    240 batches | lr 0.01 | ms/batch 95.50 | loss  4.75 | ppl   115.562
----------------------------------------------------------------------------------------------------
| Eval  25 at step     6625 | time: 28.93s | valid loss  4.76 | valid ppl   116.540
| Total time: 685.18s
----------------------------------------------------------------------------------------------------
| epoch  26 step     6700 |     75 batches | lr 0.01 | ms/batch 135.99 | loss  3.59 | ppl    36.239
| epoch  26 step     6800 |    175 batches | lr 0.01 | ms/batch 95.53 | loss  4.78 | ppl   118.641
----------------------------------------------------------------------------------------------------
| Eval  26 at step     6890 | time: 29.35s | valid loss  4.76 | valid ppl   116.255
| Total time: 712.88s
----------------------------------------------------------------------------------------------------
| epoch  27 step     6900 |     10 batches | lr 0.01 | ms/batch 132.84 | loss  0.49 | ppl     1.632
| epoch  27 step     7000 |    110 batches | lr 0.01 | ms/batch 95.54 | loss  4.78 | ppl   119.058
| epoch  27 step     7100 |    210 batches | lr 0.01 | ms/batch 95.53 | loss  4.74 | ppl   114.332
----------------------------------------------------------------------------------------------------
| Eval  27 at step     7155 | time: 29.06s | valid loss  4.75 | valid ppl   115.967
| Total time: 740.91s
----------------------------------------------------------------------------------------------------
| epoch  28 step     7200 |     45 batches | lr 0.01 | ms/batch 129.24 | loss  2.15 | ppl     8.582
| epoch  28 step     7300 |    145 batches | lr 0.01 | ms/batch 95.50 | loss  4.77 | ppl   117.365
| epoch  28 step     7400 |    245 batches | lr 0.01 | ms/batch 95.51 | loss  4.75 | ppl   115.373
----------------------------------------------------------------------------------------------------
| Eval  28 at step     7420 | time: 28.69s | valid loss  4.76 | valid ppl   116.166
| Total time: 768.80s
----------------------------------------------------------------------------------------------------
| epoch  29 step     7500 |     80 batches | lr 0.01 | ms/batch 105.93 | loss  3.82 | ppl    45.622
| epoch  29 step     7600 |    180 batches | lr 0.01 | ms/batch 95.22 | loss  4.77 | ppl   117.510
----------------------------------------------------------------------------------------------------
| Eval  29 at step     7685 | time: 26.26s | valid loss  4.76 | valid ppl   116.889
| Total time: 795.07s
----------------------------------------------------------------------------------------------------
| epoch  30 step     7700 |     15 batches | lr 0.01 | ms/batch 105.27 | loss  0.72 | ppl     2.064
| epoch  30 step     7800 |    115 batches | lr 0.01 | ms/batch 95.48 | loss  4.77 | ppl   117.469
| epoch  30 step     7900 |    215 batches | lr 0.01 | ms/batch 95.15 | loss  4.73 | ppl   113.027
----------------------------------------------------------------------------------------------------
| Eval  30 at step     7950 | time: 26.27s | valid loss  4.75 | valid ppl   116.147
| Total time: 821.35s
----------------------------------------------------------------------------------------------------
| epoch  31 step     8000 |     50 batches | lr 0.01 | ms/batch 105.36 | loss  2.38 | ppl    10.844
| epoch  31 step     8100 |    150 batches | lr 0.01 | ms/batch 95.12 | loss  4.77 | ppl   117.609
| epoch  31 step     8200 |    250 batches | lr 0.01 | ms/batch 95.15 | loss  4.72 | ppl   112.538
----------------------------------------------------------------------------------------------------
| Eval  31 at step     8215 | time: 26.23s | valid loss  4.76 | valid ppl   116.483
| Total time: 847.58s
----------------------------------------------------------------------------------------------------
| epoch  32 step     8300 |     85 batches | lr 0.01 | ms/batch 105.38 | loss  4.05 | ppl    57.638
| epoch  32 step     8400 |    185 batches | lr 0.01 | ms/batch 95.18 | loss  4.74 | ppl   114.228
----------------------------------------------------------------------------------------------------
| Eval  32 at step     8480 | time: 26.24s | valid loss  4.75 | valid ppl   115.433
| Total time: 873.83s
----------------------------------------------------------------------------------------------------
| epoch  33 step     8500 |     20 batches | lr 0.01 | ms/batch 124.45 | loss  0.96 | ppl     2.607
| epoch  33 step     8600 |    120 batches | lr 0.01 | ms/batch 95.26 | loss  4.78 | ppl   118.607
| epoch  33 step     8700 |    220 batches | lr 0.01 | ms/batch 95.26 | loss  4.70 | ppl   110.080
----------------------------------------------------------------------------------------------------
| Eval  33 at step     8745 | time: 28.17s | valid loss  4.75 | valid ppl   115.678
| Total time: 901.39s
----------------------------------------------------------------------------------------------------
| epoch  34 step     8800 |     55 batches | lr 0.01 | ms/batch 105.33 | loss  2.62 | ppl    13.696
| epoch  34 step     8900 |    155 batches | lr 0.01 | ms/batch 95.21 | loss  4.77 | ppl   118.014
| epoch  34 step     9000 |    255 batches | lr 0.01 | ms/batch 95.25 | loss  4.72 | ppl   112.409
----------------------------------------------------------------------------------------------------
| Eval  34 at step     9010 | time: 26.25s | valid loss  4.76 | valid ppl   116.255
| Total time: 927.65s
----------------------------------------------------------------------------------------------------
| epoch  35 step     9100 |     90 batches | lr 0.01 | ms/batch 105.55 | loss  4.29 | ppl    73.054
| epoch  35 step     9200 |    190 batches | lr 0.01 | ms/batch 95.35 | loss  4.73 | ppl   112.897
----------------------------------------------------------------------------------------------------
| Eval  35 at step     9275 | time: 26.29s | valid loss  4.76 | valid ppl   116.314
| Total time: 953.94s
----------------------------------------------------------------------------------------------------
| epoch  36 step     9300 |     25 batches | lr 0.01 | ms/batch 105.36 | loss  1.19 | ppl     3.292
| epoch  36 step     9400 |    125 batches | lr 0.01 | ms/batch 95.16 | loss  4.76 | ppl   116.489
| epoch  36 step     9500 |    225 batches | lr 0.01 | ms/batch 95.37 | loss  4.69 | ppl   109.364
----------------------------------------------------------------------------------------------------
| Eval  36 at step     9540 | time: 26.30s | valid loss  4.75 | valid ppl   115.251
| Total time: 980.25s
----------------------------------------------------------------------------------------------------
| epoch  37 step     9600 |     60 batches | lr 0.01 | ms/batch 124.26 | loss  2.84 | ppl    17.140
| epoch  37 step     9700 |    160 batches | lr 0.01 | ms/batch 95.21 | loss  4.76 | ppl   117.132
| epoch  37 step     9800 |    260 batches | lr 0.01 | ms/batch 95.22 | loss  4.72 | ppl   112.506
----------------------------------------------------------------------------------------------------
| Eval  37 at step     9805 | time: 28.09s | valid loss  4.75 | valid ppl   115.250
| Total time: 1007.84s
----------------------------------------------------------------------------------------------------
| epoch  38 step     9900 |     95 batches | lr 0.01 | ms/batch 125.62 | loss  4.52 | ppl    91.520
| epoch  38 step    10000 |    195 batches | lr 0.01 | ms/batch 95.44 | loss  4.70 | ppl   110.430
----------------------------------------------------------------------------------------------------
| Eval  38 at step    10070 | time: 28.35s | valid loss  4.74 | valid ppl   114.110
| Total time: 1035.61s
----------------------------------------------------------------------------------------------------
| epoch  39 step    10100 |     30 batches | lr 0.01 | ms/batch 127.45 | loss  1.43 | ppl     4.194
| epoch  39 step    10200 |    130 batches | lr 0.01 | ms/batch 95.47 | loss  4.75 | ppl   116.114
| epoch  39 step    10300 |    230 batches | lr 0.01 | ms/batch 95.49 | loss  4.69 | ppl   108.584
----------------------------------------------------------------------------------------------------
| Eval  39 at step    10335 | time: 28.51s | valid loss  4.74 | valid ppl   114.781
| Total time: 1063.61s
----------------------------------------------------------------------------------------------------
| epoch  40 step    10400 |     65 batches | lr 0.01 | ms/batch 105.97 | loss  3.08 | ppl    21.699
| epoch  40 step    10500 |    165 batches | lr 0.01 | ms/batch 95.43 | loss  4.74 | ppl   114.879
| epoch  40 step    10600 |    265 batches | lr 0.01 | ms/batch 94.64 | loss  4.69 | ppl   108.915
----------------------------------------------------------------------------------------------------
| Eval  40 at step    10600 | time: 26.29s | valid loss  4.74 | valid ppl   114.964
| Total time: 1089.92s
----------------------------------------------------------------------------------------------------
| epoch  41 step    10700 |    100 batches | lr 0.01 | ms/batch 106.13 | loss  4.75 | ppl   115.641
| epoch  41 step    10800 |    200 batches | lr 0.01 | ms/batch 95.22 | loss  4.70 | ppl   109.878
----------------------------------------------------------------------------------------------------
| Eval  41 at step    10865 | time: 26.26s | valid loss  4.74 | valid ppl   114.156
| Total time: 1116.19s
----------------------------------------------------------------------------------------------------
| epoch  42 step    10900 |     35 batches | lr 0.01 | ms/batch 105.48 | loss  1.66 | ppl     5.258
| epoch  42 step    11000 |    135 batches | lr 0.01 | ms/batch 95.34 | loss  4.74 | ppl   114.552
| epoch  42 step    11100 |    235 batches | lr 0.01 | ms/batch 95.06 | loss  4.70 | ppl   110.151
----------------------------------------------------------------------------------------------------
| Eval  42 at step    11130 | time: 26.25s | valid loss  4.73 | valid ppl   113.237
| Total time: 1142.45s
----------------------------------------------------------------------------------------------------
| epoch  43 step    11200 |     70 batches | lr 0.01 | ms/batch 125.80 | loss  3.32 | ppl    27.629
| epoch  43 step    11300 |    170 batches | lr 0.01 | ms/batch 95.32 | loss  4.75 | ppl   115.899
----------------------------------------------------------------------------------------------------
| Eval  43 at step    11395 | time: 28.31s | valid loss  4.73 | valid ppl   112.968
| Total time: 1170.19s
----------------------------------------------------------------------------------------------------
| epoch  44 step    11400 |      5 batches | lr 0.01 | ms/batch 125.10 | loss  0.25 | ppl     1.280
| epoch  44 step    11500 |    105 batches | lr 0.01 | ms/batch 95.26 | loss  4.75 | ppl   115.016
| epoch  44 step    11600 |    205 batches | lr 0.01 | ms/batch 95.10 | loss  4.70 | ppl   109.801
----------------------------------------------------------------------------------------------------
| Eval  44 at step    11660 | time: 28.21s | valid loss  4.74 | valid ppl   114.378
| Total time: 1197.84s
----------------------------------------------------------------------------------------------------
| epoch  45 step    11700 |     40 batches | lr 0.01 | ms/batch 105.41 | loss  1.91 | ppl     6.740
| epoch  45 step    11800 |    140 batches | lr 0.01 | ms/batch 95.23 | loss  4.74 | ppl   114.561
| epoch  45 step    11900 |    240 batches | lr 0.01 | ms/batch 95.30 | loss  4.68 | ppl   107.907
----------------------------------------------------------------------------------------------------
| Eval  45 at step    11925 | time: 26.25s | valid loss  4.74 | valid ppl   114.134
| Total time: 1224.10s
----------------------------------------------------------------------------------------------------
| epoch  46 step    12000 |     75 batches | lr 0.01 | ms/batch 105.38 | loss  3.55 | ppl    34.830
| epoch  46 step    12100 |    175 batches | lr 0.01 | ms/batch 95.32 | loss  4.74 | ppl   114.215
----------------------------------------------------------------------------------------------------
| Eval  46 at step    12190 | time: 26.26s | valid loss  4.73 | valid ppl   112.791
| Total time: 1250.37s
----------------------------------------------------------------------------------------------------
| epoch  47 step    12200 |     10 batches | lr 0.01 | ms/batch 126.48 | loss  0.49 | ppl     1.626
| epoch  47 step    12300 |    110 batches | lr 0.01 | ms/batch 95.31 | loss  4.73 | ppl   112.807
| epoch  47 step    12400 |    210 batches | lr 0.01 | ms/batch 95.25 | loss  4.69 | ppl   109.010
----------------------------------------------------------------------------------------------------
| Eval  47 at step    12455 | time: 28.38s | valid loss  4.73 | valid ppl   112.882
| Total time: 1278.11s
----------------------------------------------------------------------------------------------------
| epoch  48 step    12500 |     45 batches | lr 0.01 | ms/batch 105.46 | loss  2.13 | ppl     8.392
| epoch  48 step    12600 |    145 batches | lr 0.01 | ms/batch 95.31 | loss  4.74 | ppl   114.295
| epoch  48 step    12700 |    245 batches | lr 0.01 | ms/batch 95.24 | loss  4.70 | ppl   109.554
----------------------------------------------------------------------------------------------------
| Eval  48 at step    12720 | time: 26.27s | valid loss  4.72 | valid ppl   112.644
| Total time: 1304.39s
----------------------------------------------------------------------------------------------------
| epoch  49 step    12800 |     80 batches | lr 0.01 | ms/batch 127.88 | loss  3.79 | ppl    44.310
| epoch  49 step    12900 |    180 batches | lr 0.01 | ms/batch 95.33 | loss  4.72 | ppl   111.804
----------------------------------------------------------------------------------------------------
| Eval  49 at step    12985 | time: 28.51s | valid loss  4.72 | valid ppl   112.185
| Total time: 1331.98s
----------------------------------------------------------------------------------------------------
| epoch  50 step    13000 |     15 batches | lr 0.01 | ms/batch 125.49 | loss  0.72 | ppl     2.054
| epoch  50 step    13100 |    115 batches | lr 0.01 | ms/batch 95.43 | loss  4.73 | ppl   113.308
| epoch  50 step    13200 |    215 batches | lr 0.01 | ms/batch 95.35 | loss  4.69 | ppl   109.186
----------------------------------------------------------------------------------------------------
| Eval  50 at step    13250 | time: 28.30s | valid loss  4.72 | valid ppl   112.143
| Total time: 1359.71s
----------------------------------------------------------------------------------------------------
| epoch  51 step    13300 |     50 batches | lr 0.01 | ms/batch 125.98 | loss  2.37 | ppl    10.675
| epoch  51 step    13400 |    150 batches | lr 0.01 | ms/batch 95.51 | loss  4.74 | ppl   114.027
| epoch  51 step    13500 |    250 batches | lr 0.01 | ms/batch 95.32 | loss  4.68 | ppl   108.033
----------------------------------------------------------------------------------------------------
| Eval  51 at step    13515 | time: 28.38s | valid loss  4.73 | valid ppl   113.167
| Total time: 1387.37s
----------------------------------------------------------------------------------------------------
| epoch  52 step    13600 |     85 batches | lr 0.01 | ms/batch 106.04 | loss  4.03 | ppl    56.118
| epoch  52 step    13700 |    185 batches | lr 0.01 | ms/batch 95.22 | loss  4.71 | ppl   110.865
----------------------------------------------------------------------------------------------------
| Eval  52 at step    13780 | time: 26.29s | valid loss  4.73 | valid ppl   113.317
| Total time: 1413.67s
----------------------------------------------------------------------------------------------------
| epoch  53 step    13800 |     20 batches | lr 0.01 | ms/batch 105.48 | loss  0.96 | ppl     2.607
| epoch  53 step    13900 |    120 batches | lr 0.01 | ms/batch 95.13 | loss  4.73 | ppl   113.326
| epoch  53 step    14000 |    220 batches | lr 0.01 | ms/batch 95.12 | loss  4.68 | ppl   107.958
----------------------------------------------------------------------------------------------------
| Eval  53 at step    14045 | time: 26.27s | valid loss  4.73 | valid ppl   113.644
| Total time: 1439.95s
----------------------------------------------------------------------------------------------------
| epoch  54 step    14100 |     55 batches | lr 0.001 | ms/batch 105.88 | loss  2.59 | ppl    13.344
| epoch  54 step    14200 |    155 batches | lr 0.001 | ms/batch 95.37 | loss  4.66 | ppl   105.753
| epoch  54 step    14300 |    255 batches | lr 0.001 | ms/batch 95.44 | loss  4.49 | ppl    89.149
----------------------------------------------------------------------------------------------------
| Eval  54 at step    14310 | time: 26.30s | valid loss  4.71 | valid ppl   110.723
| Total time: 1466.26s
----------------------------------------------------------------------------------------------------
| epoch  55 step    14400 |     90 batches | lr 0.001 | ms/batch 124.79 | loss  4.20 | ppl    66.824
| epoch  55 step    14500 |    190 batches | lr 0.001 | ms/batch 95.28 | loss  4.55 | ppl    94.372
----------------------------------------------------------------------------------------------------
| Eval  55 at step    14575 | time: 28.26s | valid loss  4.69 | valid ppl   109.054
| Total time: 1493.90s
----------------------------------------------------------------------------------------------------
| epoch  56 step    14600 |     25 batches | lr 0.001 | ms/batch 126.55 | loss  1.17 | ppl     3.210
| epoch  56 step    14700 |    125 batches | lr 0.001 | ms/batch 95.46 | loss  4.61 | ppl   100.197
| epoch  56 step    14800 |    225 batches | lr 0.001 | ms/batch 95.55 | loss  4.47 | ppl    87.005
----------------------------------------------------------------------------------------------------
| Eval  56 at step    14840 | time: 28.45s | valid loss  4.69 | valid ppl   108.549
| Total time: 1521.63s
----------------------------------------------------------------------------------------------------
| epoch  57 step    14900 |     60 batches | lr 0.001 | ms/batch 125.01 | loss  2.75 | ppl    15.669
| epoch  57 step    15000 |    160 batches | lr 0.001 | ms/batch 95.13 | loss  4.57 | ppl    96.900
| epoch  57 step    15100 |    260 batches | lr 0.001 | ms/batch 3032.86 | loss  4.41 | ppl    82.518
----------------------------------------------------------------------------------------------------
| Eval  57 at step    15105 | time: 410.32s | valid loss  4.57 | valid ppl    96.706
| Total time: 1931.54s
----------------------------------------------------------------------------------------------------
| epoch  58 step    15200 |     95 batches | lr 0.001 | ms/batch 3801.52 | loss  4.29 | ppl    73.309
| epoch  58 step    15300 |    195 batches | lr 0.001 | ms/batch 3031.73 | loss  4.40 | ppl    81.297
----------------------------------------------------------------------------------------------------
| Eval  58 at step    15370 | time: 879.78s | valid loss  4.55 | valid ppl    94.777
| Total time: 2811.18s
----------------------------------------------------------------------------------------------------
| epoch  59 step    15400 |     30 batches | lr 0.001 | ms/batch 3792.48 | loss  1.36 | ppl     3.887
| epoch  59 step    15500 |    130 batches | lr 0.001 | ms/batch 3030.57 | loss  4.45 | ppl    86.025
| epoch  59 step    15600 |    230 batches | lr 0.001 | ms/batch 3030.43 | loss  4.33 | ppl    76.282
----------------------------------------------------------------------------------------------------
| Eval  59 at step    15635 | time: 879.09s | valid loss  4.55 | valid ppl    94.549
| Total time: 3689.94s
----------------------------------------------------------------------------------------------------
| epoch  60 step    15700 |     65 batches | lr 0.001 | ms/batch 3788.51 | loss  2.89 | ppl    18.002
| epoch  60 step    15800 |    165 batches | lr 0.001 | ms/batch 3028.80 | loss  4.42 | ppl    82.948
| epoch  60 step    15900 |    265 batches | lr 0.001 | ms/batch 3003.01 | loss  4.30 | ppl    73.953
----------------------------------------------------------------------------------------------------
| Eval  60 at step    15900 | time: 879.16s | valid loss  4.57 | valid ppl    96.203
| Total time: 4568.90s
----------------------------------------------------------------------------------------------------
| epoch  61 step    16000 |    100 batches | lr 0.001 | ms/batch 3797.53 | loss  4.44 | ppl    85.108
| epoch  61 step    16100 |    200 batches | lr 0.001 | ms/batch 3027.68 | loss  4.32 | ppl    74.945
----------------------------------------------------------------------------------------------------
| Eval  61 at step    16165 | time: 876.00s | valid loss  4.89 | valid ppl   133.608
| Total time: 5445.34s
----------------------------------------------------------------------------------------------------
| epoch  62 step    16200 |     35 batches | lr 0.0001 | ms/batch 3762.80 | loss  1.67 | ppl     5.292
| epoch  62 step    16300 |    135 batches | lr 0.0001 | ms/batch 3020.75 | loss  4.57 | ppl    96.952
| epoch  62 step    16400 |    235 batches | lr 0.0001 | ms/batch 3019.78 | loss  4.56 | ppl    95.954
----------------------------------------------------------------------------------------------------
| Eval  62 at step    16430 | time: 874.45s | valid loss  4.55 | valid ppl    94.587
| Total time: 6320.16s
----------------------------------------------------------------------------------------------------
| epoch  63 step    16500 |     70 batches | lr 0.0001 | ms/batch 3761.93 | loss  3.20 | ppl    24.501
| epoch  63 step    16600 |    170 batches | lr 0.0001 | ms/batch 3020.63 | loss  4.52 | ppl    91.407
----------------------------------------------------------------------------------------------------
| Eval  63 at step    16695 | time: 875.40s | valid loss  4.54 | valid ppl    93.577
| Total time: 7195.98s
----------------------------------------------------------------------------------------------------
| epoch  64 step    16700 |      5 batches | lr 0.0001 | ms/batch 3795.95 | loss  0.24 | ppl     1.266
| epoch  64 step    16800 |    105 batches | lr 0.0001 | ms/batch 3021.32 | loss  4.53 | ppl    92.887
| epoch  64 step    16900 |    205 batches | lr 0.0001 | ms/batch 3022.38 | loss  4.38 | ppl    80.040
----------------------------------------------------------------------------------------------------
| Eval  64 at step    16960 | time: 877.91s | valid loss  4.53 | valid ppl    92.833
| Total time: 8073.19s
----------------------------------------------------------------------------------------------------
| epoch  65 step    17000 |     40 batches | lr 0.0001 | ms/batch 3787.43 | loss  1.78 | ppl     5.912
| epoch  65 step    17100 |    140 batches | lr 0.0001 | ms/batch 3024.87 | loss  4.40 | ppl    81.384
| epoch  65 step    17200 |    240 batches | lr 0.0001 | ms/batch 3023.82 | loss  4.28 | ppl    72.234
----------------------------------------------------------------------------------------------------
| Eval  65 at step    17225 | time: 878.12s | valid loss  4.53 | valid ppl    92.459
| Total time: 8951.07s
----------------------------------------------------------------------------------------------------
| epoch  66 step    17300 |     75 batches | lr 0.0001 | ms/batch 3791.21 | loss  3.31 | ppl    27.422
| epoch  66 step    17400 |    175 batches | lr 0.0001 | ms/batch 3023.59 | loss  4.36 | ppl    78.225
----------------------------------------------------------------------------------------------------
| Eval  66 at step    17490 | time: 877.95s | valid loss  4.52 | valid ppl    92.034
| Total time: 9828.89s
----------------------------------------------------------------------------------------------------
| epoch  67 step    17500 |     10 batches | lr 0.0001 | ms/batch 3792.68 | loss  0.45 | ppl     1.576
| epoch  67 step    17600 |    110 batches | lr 0.0001 | ms/batch 3025.37 | loss  4.39 | ppl    80.991
| epoch  67 step    17700 |    210 batches | lr 0.0001 | ms/batch 3024.74 | loss  4.29 | ppl    73.181
----------------------------------------------------------------------------------------------------
| Eval  67 at step    17755 | time: 878.23s | valid loss  4.52 | valid ppl    91.833
| Total time: 10707.05s
----------------------------------------------------------------------------------------------------
| epoch  68 step    17800 |     45 batches | lr 0.0001 | ms/batch 3788.24 | loss  1.99 | ppl     7.320
| epoch  68 step    17900 |    145 batches | lr 0.0001 | ms/batch 3024.09 | loss  4.36 | ppl    78.319
| epoch  68 step    18000 |    245 batches | lr 0.0001 | ms/batch 3022.54 | loss  4.27 | ppl    71.174
----------------------------------------------------------------------------------------------------
| Eval  68 at step    18020 | time: 877.57s | valid loss  4.52 | valid ppl    91.864
| Total time: 11584.50s
----------------------------------------------------------------------------------------------------
| epoch  69 step    18100 |     80 batches | lr 0.0001 | ms/batch 3767.48 | loss  3.54 | ppl    34.330
| epoch  69 step    18200 |    180 batches | lr 0.0001 | ms/batch 3021.22 | loss  4.36 | ppl    78.010
----------------------------------------------------------------------------------------------------
| Eval  69 at step    18285 | time: 874.71s | valid loss  4.52 | valid ppl    91.774
| Total time: 12459.60s
----------------------------------------------------------------------------------------------------
| epoch  70 step    18300 |     15 batches | lr 0.0001 | ms/batch 3781.32 | loss  0.67 | ppl     1.958
| epoch  70 step    18400 |    115 batches | lr 0.0001 | ms/batch 3019.58 | loss  4.38 | ppl    80.007
| epoch  70 step    18500 |    215 batches | lr 0.0001 | ms/batch 3025.73 | loss  4.30 | ppl    73.385
----------------------------------------------------------------------------------------------------
| Eval  70 at step    18550 | time: 877.93s | valid loss  4.52 | valid ppl    91.440
| Total time: 13337.38s
----------------------------------------------------------------------------------------------------
| epoch  71 step    18600 |     50 batches | lr 0.0001 | ms/batch 3793.78 | loss  2.21 | ppl     9.078
| epoch  71 step    18700 |    150 batches | lr 0.0001 | ms/batch 3024.11 | loss  4.37 | ppl    79.387
| epoch  71 step    18800 |    250 batches | lr 0.0001 | ms/batch 3022.06 | loss  4.26 | ppl    71.145
----------------------------------------------------------------------------------------------------
| Eval  71 at step    18815 | time: 877.56s | valid loss  4.52 | valid ppl    91.572
| Total time: 14214.80s
----------------------------------------------------------------------------------------------------
| epoch  72 step    18900 |     85 batches | lr 0.0001 | ms/batch 3764.01 | loss  3.75 | ppl    42.355
| epoch  72 step    19000 |    185 batches | lr 0.0001 | ms/batch 3022.77 | loss  4.32 | ppl    75.239
----------------------------------------------------------------------------------------------------
| Eval  72 at step    19080 | time: 875.34s | valid loss  4.51 | valid ppl    91.346
| Total time: 15090.55s
----------------------------------------------------------------------------------------------------
| epoch  73 step    19100 |     20 batches | lr 0.0001 | ms/batch 3794.00 | loss  0.89 | ppl     2.428
| epoch  73 step    19200 |    120 batches | lr 0.0001 | ms/batch 3022.76 | loss  4.38 | ppl    79.995
| epoch  73 step    19300 |    220 batches | lr 0.0001 | ms/batch 3023.30 | loss  4.27 | ppl    71.716
----------------------------------------------------------------------------------------------------
| Eval  73 at step    19345 | time: 878.63s | valid loss  4.51 | valid ppl    91.002
| Total time: 15968.28s
----------------------------------------------------------------------------------------------------
| epoch  74 step    19400 |     55 batches | lr 0.0001 | ms/batch 3793.22 | loss  2.40 | ppl    11.038
| epoch  74 step    19500 |    155 batches | lr 0.0001 | ms/batch 3023.77 | loss  4.36 | ppl    78.064
| epoch  74 step    19600 |    255 batches | lr 0.0001 | ms/batch 3023.91 | loss  4.27 | ppl    71.813
----------------------------------------------------------------------------------------------------
| Eval  74 at step    19610 | time: 878.60s | valid loss  4.51 | valid ppl    91.004
| Total time: 16846.66s
----------------------------------------------------------------------------------------------------
====================================================================================================
| End of training | test loss  4.46 | test ppl    86.425
| Maximum memory usage: 5569.32MB
====================================================================================================
